<section class="rc-CourseReferencesPage"><h1 class="tab-headline"><span>Week 9 Lecture Notes </span></h1><div class="rc-CML styled"><div><h1>ML:Anomaly Detection</h1><h1>Problem Motivation</h1><p>Just like in other learning problems, we are given a dataset <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-907-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-28391"><span style="display: inline-block; position: relative; width: 118px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(26.4px 17360px 49.4px -9.5px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-28392"><span class="texatom" id="MathJax-Span-28393"><span class="mrow" id="MathJax-Span-28394"><span class="msubsup" id="MathJax-Span-28395"><span style="display: inline-block; position: relative; width: 24.2px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -9.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28396" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 8.9px;"><span class="texatom" id="MathJax-Span-28397"><span class="mrow" id="MathJax-Span-28398"><span class="mo" id="MathJax-Span-28399" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-28400" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-28401" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-28402" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-28403" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 24.2px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -9.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28404" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 8.9px;"><span class="texatom" id="MathJax-Span-28405"><span class="mrow" id="MathJax-Span-28406"><span class="mo" id="MathJax-Span-28407" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-28408" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span class="mo" id="MathJax-Span-28409" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-28410" style="font-family: STIXGeneral;">,</span><span class="mo" id="MathJax-Span-28411" style="font-family: STIXGeneral; padding-left: 3.3px;">…</span><span class="mo" id="MathJax-Span-28412" style="font-family: STIXGeneral; padding-left: 3.3px;">,</span><span class="msubsup" id="MathJax-Span-28413" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 27.2px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -9.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28414" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 8.9px;"><span class="texatom" id="MathJax-Span-28415"><span class="mrow" id="MathJax-Span-28416"><span class="mo" id="MathJax-Span-28417" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-28418" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">m</span><span class="mo" id="MathJax-Span-28419" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 19px; vertical-align: -3.4px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-907">{x^{(1)}, x^{(2)},\dots,x^{(m)}}</script>.</p><p>We are then given a new example, <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-908-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-28420"><span style="display: inline-block; position: relative; width: 26px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(30.3px 17360px 46.8px -9.5px); top: -41px; left: 0px;"><span class="mrow" id="MathJax-Span-28421"><span class="msubsup" id="MathJax-Span-28422"><span style="display: inline-block; position: relative; width: 26.2px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -9.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28423" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -39.4px; left: 7.9px;"><span class="texatom" id="MathJax-Span-28424"><span class="mrow" id="MathJax-Span-28425"><span class="mi" id="MathJax-Span-28426" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span class="mi" id="MathJax-Span-28427" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">e</span><span class="mi" id="MathJax-Span-28428" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">s</span><span class="mi" id="MathJax-Span-28429" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 12.4px; vertical-align: -3.8px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-908">x_{test}</script>, and we want to know whether this new example is abnormal/anomalous.</p><p>We define a "model" p(x) that tells us the probability the example is not anomalous. We also use a threshold ϵ (epsilon) as a dividing line so we can say which examples are anomalous and which are not.</p><p>A very common application of anomaly detection is detecting fraud:</p><ul><li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-909-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-28430"><span style="display: inline-block; position: relative; width: 39px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(26.4px 17360px 47.2px -9.5px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-28431"><span class="msubsup" id="MathJax-Span-28432"><span style="display: inline-block; position: relative; width: 22.2px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -9.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28433" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 8.9px;"><span class="texatom" id="MathJax-Span-28434"><span class="mrow" id="MathJax-Span-28435"><span class="mo" id="MathJax-Span-28436" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-28437" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-28438" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-28439" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 16.8px; vertical-align: -1.2px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-909">x^{(i)} =</script> features of user i's activities</li><li>Model p(x) from the data.</li><li>Identify unusual users by checking which have p(x)&lt;ϵ.</li></ul><p>If our anomaly detector is flagging <strong>too many</strong> anomalous examples, then we need to <strong>decrease</strong> our threshold ϵ</p><h1>Gaussian Distribution</h1><p>The Gaussian Distribution is a familiar bell-shaped curve that can be described by a function <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-910-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-28440"><span style="display: inline-block; position: relative; width: 64px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(34.4px 17360px 58.6px -8.3px); top: -52px; left: 0px;"><span class="mrow" id="MathJax-Span-28441"><span class="texatom" id="MathJax-Span-28442"><span class="mrow" id="MathJax-Span-28443"><span class="mi" id="MathJax-Span-28444" style="font-family: STIXNonUnicode; font-style: italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 1.9px;"></span></span></span></span><span class="mo" id="MathJax-Span-28445" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-28446" style="font-family: STIXGeneral; font-style: italic;">μ</span><span class="mo" id="MathJax-Span-28447" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-28448" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 17.3px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 47.2px -8.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28449" style="font-family: STIXGeneral; font-style: italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.6px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 10px;"><span class="mn" id="MathJax-Span-28450" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-28451" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 52px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 20.2px; vertical-align: -4.6px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-910">\mathcal{N}(\mu,\sigma^2)</script></p><p>Let x∈ℝ. If the probability distribution of x is Gaussian with mean μ, variance <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-911-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-28452"><span style="display: inline-block; position: relative; width: 17px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(23.4px 17360px 44.2px -8.5px); top: -41px; left: 0px;"><span class="mrow" id="MathJax-Span-28453"><span class="msubsup" id="MathJax-Span-28454"><span style="display: inline-block; position: relative; width: 17.3px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 47.2px -8.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28455" style="font-family: STIXGeneral; font-style: italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.6px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 10px;"><span class="mn" id="MathJax-Span-28456" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 16.8px; vertical-align: -1.2px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-911">\sigma^2</script>, then:</p><p><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-912-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-28457"><span style="display: inline-block; position: relative; width: 93px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(34.4px 17360px 58.6px -9.5px); top: -52px; left: 0px;"><span class="mrow" id="MathJax-Span-28458"><span class="mi" id="MathJax-Span-28459" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span class="mo" id="MathJax-Span-28460" style="font-family: STIXGeneral; padding-left: 5.4px;">∼</span><span class="texatom" id="MathJax-Span-28461" style="padding-left: 5.4px;"><span class="mrow" id="MathJax-Span-28462"><span class="mi" id="MathJax-Span-28463" style="font-family: STIXNonUnicode; font-style: italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 1.9px;"></span></span></span></span><span class="mo" id="MathJax-Span-28464" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-28465" style="font-family: STIXGeneral; font-style: italic;">μ</span><span class="mo" id="MathJax-Span-28466" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-28467" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 17.3px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 47.2px -8.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28468" style="font-family: STIXGeneral; font-style: italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.6px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 10px;"><span class="mn" id="MathJax-Span-28469" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-28470" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 52px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 20.2px; vertical-align: -4.6px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-912">x \sim \mathcal{N}(\mu, \sigma^2)</script></p><p>The little ∼ or 'tilde' can be read as "distributed as."</p><p>The Gaussian Distribution is parameterized by a mean and a variance.</p><p>Mu, or μ, describes the center of the curve, called the mean. The width of the curve is described by sigma, or σ, called the standard deviation.</p><p>The full function is as follows:</p><p><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-913-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-28471"><span style="display: inline-block; position: relative; width: 311px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(5px 17360px 88px -10.8px); top: -53px; left: 0px;"><span class="mrow" id="MathJax-Span-28472"><span class="mstyle" id="MathJax-Span-28473"><span class="mrow" id="MathJax-Span-28474"><span class="mi" id="MathJax-Span-28475" style="font-size: 135%; font-family: STIXGeneral; font-style: italic;">p</span><span class="mo" id="MathJax-Span-28476" style="font-size: 135%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-28477" style="font-size: 135%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span class="mo" id="MathJax-Span-28478" style="font-size: 135%; font-family: STIXGeneral;">;</span><span class="mi" id="MathJax-Span-28479" style="font-size: 135%; font-family: STIXGeneral; font-style: italic; padding-left: 2.4px;">μ</span><span class="mo" id="MathJax-Span-28480" style="font-size: 135%; font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-28481" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 22.4px; height: 0px;"><span style="position: absolute; clip: rect(40px 17360px 56.3px -8.4px); top: -53px; left: 0px;"><span class="mi" id="MathJax-Span-28482" style="font-size: 135%; font-family: STIXGeneral; font-style: italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.8px;"></span></span><span style="display: inline-block; width: 0px; height: 53px;"></span></span><span style="position: absolute; top: -50.3px; left: 13.1px;"><span class="mn" id="MathJax-Span-28483" style="font-size: 95.5%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span></span><span class="mo" id="MathJax-Span-28484" style="font-size: 135%; font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-28485" style="font-size: 135%; font-family: STIXGeneral; padding-left: 4px;">=</span><span class="mstyle" id="MathJax-Span-28486" style="padding-left: 5.4px;"><span class="mrow" id="MathJax-Span-28487"><span class="mfrac" id="MathJax-Span-28488" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 73.1px; height: 0px;"><span style="position: absolute; clip: rect(34.2px 17360px 56px -6.4px); top: -64.7px; left: 50%; margin-left: -6px;"><span class="mn" id="MathJax-Span-28489" style="font-size: 135%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 53px;"></span></span><span style="position: absolute; clip: rect(27.8px 17360px 66.1px -8.4px); top: -31.1px; left: 50%; margin-left: -35.5px;"><span class="mrow" id="MathJax-Span-28490"><span class="mi" id="MathJax-Span-28491" style="font-size: 135%; font-family: STIXGeneral; font-style: italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.8px;"></span></span><span class="msqrt" id="MathJax-Span-28492"><span style="display: inline-block; position: relative; width: 58.4px; height: 0px;"><span style="position: absolute; clip: rect(34.2px 17360px 60.1px -7.9px); top: -53px; left: 18px;"><span class="mrow" id="MathJax-Span-28493"><span class="mo" id="MathJax-Span-28494" style="font-size: 135%; font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-28495" style="font-size: 135%; font-family: STIXGeneral;">2</span><span class="mi" id="MathJax-Span-28496" style="font-size: 135%; font-family: STIXGeneral; font-style: italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.7px;"></span></span><span class="mo" id="MathJax-Span-28497" style="font-size: 135%; font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 53px;"></span></span><span style="position: absolute; clip: rect(51.8px 17360px 58.6px -9px); top: -77px; left: 18px;"><span style="display: inline-block; position: relative; width: 40.4px; height: 0px;"><span style="position: absolute; font-family: STIXGeneral; top: -69px; left: 0px;">‾<span style="display: inline-block; width: 0px; height: 69px;"></span></span><span style="position: absolute; font-family: STIXGeneral; top: -69px; left: 31.8px;">‾<span style="display: inline-block; width: 0px; height: 69px;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -69px; left: 6px;">‾<span style="display: inline-block; width: 0px; height: 69px;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -69px; left: 12.4px;">‾<span style="display: inline-block; width: 0px; height: 69px;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -69px; left: 18.9px;">‾<span style="display: inline-block; width: 0px; height: 69px;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -69px; left: 25.3px;">‾<span style="display: inline-block; width: 0px; height: 69px;"></span></span></span><span style="display: inline-block; width: 0px; height: 69px;"></span></span><span style="position: absolute; clip: rect(39.1px 17360px 77.1px -7.1px); top: -64px; left: 0px;"><span style="font-family: STIXSizeOneSym;">√</span><span style="display: inline-block; width: 0px; height: 69px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 53px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 73.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span></span></span><span class="msubsup" id="MathJax-Span-28498" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 116.3px; height: 0px;"><span style="position: absolute; clip: rect(39.7px 17360px 56.3px -8.3px); top: -53px; left: 0px;"><span class="mi" id="MathJax-Span-28499" style="font-size: 135%; font-family: STIXGeneral; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 53px;"></span></span><span style="position: absolute; top: -61.4px; left: 10px;"><span class="texatom" id="MathJax-Span-28500"><span class="mrow" id="MathJax-Span-28501"><span class="mo" id="MathJax-Span-28502" style="font-size: 95.5%; font-family: STIXGeneral;">−</span><span class="mstyle" id="MathJax-Span-28503" style="padding-left: 3.3px;"><span class="mrow" id="MathJax-Span-28504"><span class="mfrac" id="MathJax-Span-28505" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 14.1px; height: 0px;"><span style="position: absolute; clip: rect(34.2px 17360px 56px -6.4px); top: -64.7px; left: 50%; margin-left: -6px;"><span class="mn" id="MathJax-Span-28506" style="font-size: 135%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 53px;"></span></span><span style="position: absolute; clip: rect(34.2px 17360px 56px -8.3px); top: -37.4px; left: 50%; margin-left: -6px;"><span class="mn" id="MathJax-Span-28507" style="font-size: 135%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 53px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 14.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-28508" style="font-size: 95.5%; font-family: STIXGeneral; padding-left: 3.4px;">(</span><span class="mstyle" id="MathJax-Span-28509"><span class="mrow" id="MathJax-Span-28510"><span class="mfrac" id="MathJax-Span-28511" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 47.1px; height: 0px;"><span style="position: absolute; clip: rect(39.7px 17360px 60.8px -9.6px); top: -66.2px; left: 50%; margin-left: -22.5px;"><span class="mrow" id="MathJax-Span-28512"><span class="mi" id="MathJax-Span-28513" style="font-size: 135%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span class="mo" id="MathJax-Span-28514" style="font-size: 135%; font-family: STIXGeneral; padding-left: 3.2px;">−</span><span class="mi" id="MathJax-Span-28515" style="font-size: 135%; font-family: STIXGeneral; font-style: italic; padding-left: 3.2px;">μ</span></span><span style="display: inline-block; width: 0px; height: 53px;"></span></span><span style="position: absolute; clip: rect(40px 17360px 56.3px -8.4px); top: -41.1px; left: 50%; margin-left: -6px;"><span class="mi" id="MathJax-Span-28516" style="font-size: 135%; font-family: STIXGeneral; font-style: italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.8px;"></span></span><span style="display: inline-block; width: 0px; height: 53px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 47.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span></span></span><span class="msubsup" id="MathJax-Span-28517"><span style="display: inline-block; position: relative; width: 12.9px; height: 0px;"><span style="position: absolute; clip: rect(29.8px 17360px 49.9px -8.5px); top: -44px; left: 0px;"><span class="mo" id="MathJax-Span-28518" style="font-size: 95.5%; font-family: STIXGeneral;">)</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -47.7px; left: 6px;"><span class="mn" id="MathJax-Span-28519" style="font-size: 67.5%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 53px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 79px; vertical-align: -33px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-913">\large p(x;\mu,\sigma^2) = \dfrac{1}{\sigma\sqrt{(2\pi)}}e^{-\dfrac{1}{2}(\dfrac{x - \mu}{\sigma})^2}</script></p><p>We can estimate the parameter μ from a given dataset by simply taking the average of all the examples:</p><p><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-914-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-28520"><span style="display: inline-block; position: relative; width: 100px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(13px 17360px 68.8px -9.6px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-28521"><span class="mi" id="MathJax-Span-28522" style="font-family: STIXGeneral; font-style: italic;">μ</span><span class="mo" id="MathJax-Span-28523" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="mstyle" id="MathJax-Span-28524" style="padding-left: 5.4px;"><span class="mrow" id="MathJax-Span-28525"><span class="mfrac" id="MathJax-Span-28526" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 15.1px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 47px -7.1px); top: -55.7px; left: 50%; margin-left: -4.5px;"><span class="mn" id="MathJax-Span-28527" style="font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.8px); top: -32.1px; left: 50%; margin-left: -6.5px;"><span class="mi" id="MathJax-Span-28528" style="font-family: STIXGeneral; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 15.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span></span></span><span class="mstyle" id="MathJax-Span-28529" style="padding-left: 3.3px;"><span class="mrow" id="MathJax-Span-28530"><span class="munderover" id="MathJax-Span-28531"><span style="display: inline-block; position: relative; width: 22px; height: 0px;"><span style="position: absolute; clip: rect(31.1px 17360px 62.2px -7.4px); top: -51px; left: 0px;"><span class="mo" id="MathJax-Span-28532" style="font-family: STIXSizeOneSym; vertical-align: -9.1px;">∑</span><span style="display: inline-block; width: 0px; height: 51px;"></span></span><span style="position: absolute; clip: rect(30.7px 17360px 46.9px -8.4px); top: -22px; left: 2px;"><span class="texatom" id="MathJax-Span-28533"><span class="mrow" id="MathJax-Span-28534"><span class="mi" id="MathJax-Span-28535" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-28536" style="font-size: 70.7%; font-family: STIXGeneral;">=</span><span class="mn" id="MathJax-Span-28537" style="font-size: 70.7%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(31.9px 17360px 45.1px -8.9px); top: -62.8px; left: 6.5px;"><span class="mi" id="MathJax-Span-28538" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="msubsup" id="MathJax-Span-28539" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 22.2px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -9.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28540" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49.2px; left: 8.9px;"><span class="texatom" id="MathJax-Span-28541"><span class="mrow" id="MathJax-Span-28542"><span class="mo" id="MathJax-Span-28543" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-28544" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-28545" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 51.8px; vertical-align: -22.8px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-914">\mu = \dfrac{1}{m}\displaystyle \sum_{i=1}^m x^{(i)}</script></p><p>We can estimate the other parameter, <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-915-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-28546"><span style="display: inline-block; position: relative; width: 17px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(23.4px 17360px 44.2px -8.5px); top: -41px; left: 0px;"><span class="mrow" id="MathJax-Span-28547"><span class="msubsup" id="MathJax-Span-28548"><span style="display: inline-block; position: relative; width: 17.3px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 47.2px -8.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28549" style="font-family: STIXGeneral; font-style: italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.6px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 10px;"><span class="mn" id="MathJax-Span-28550" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 16.8px; vertical-align: -1.2px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-915">\sigma^2</script>, with our familiar squared error formula:</p><p><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-916-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-28551"><span style="display: inline-block; position: relative; width: 154px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(13px 17360px 68.8px -8.5px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-28552"><span class="msubsup" id="MathJax-Span-28553"><span style="display: inline-block; position: relative; width: 17.3px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 47.2px -8.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28554" style="font-family: STIXGeneral; font-style: italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.6px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 10px;"><span class="mn" id="MathJax-Span-28555" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-28556" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="mstyle" id="MathJax-Span-28557" style="padding-left: 5.4px;"><span class="mrow" id="MathJax-Span-28558"><span class="mfrac" id="MathJax-Span-28559" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 15.1px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 47px -7.1px); top: -55.7px; left: 50%; margin-left: -4.5px;"><span class="mn" id="MathJax-Span-28560" style="font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.8px); top: -32.1px; left: 50%; margin-left: -6.5px;"><span class="mi" id="MathJax-Span-28561" style="font-family: STIXGeneral; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 15.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span></span></span><span class="mstyle" id="MathJax-Span-28562" style="padding-left: 3.3px;"><span class="mrow" id="MathJax-Span-28563"><span class="munderover" id="MathJax-Span-28564"><span style="display: inline-block; position: relative; width: 22px; height: 0px;"><span style="position: absolute; clip: rect(31.1px 17360px 62.2px -7.4px); top: -51px; left: 0px;"><span class="mo" id="MathJax-Span-28565" style="font-family: STIXSizeOneSym; vertical-align: -9.1px;">∑</span><span style="display: inline-block; width: 0px; height: 51px;"></span></span><span style="position: absolute; clip: rect(30.7px 17360px 46.9px -8.4px); top: -22px; left: 2px;"><span class="texatom" id="MathJax-Span-28566"><span class="mrow" id="MathJax-Span-28567"><span class="mi" id="MathJax-Span-28568" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-28569" style="font-size: 70.7%; font-family: STIXGeneral;">=</span><span class="mn" id="MathJax-Span-28570" style="font-size: 70.7%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(31.9px 17360px 45.1px -8.9px); top: -62.8px; left: 6.5px;"><span class="mi" id="MathJax-Span-28571" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-28572" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-28573"><span style="display: inline-block; position: relative; width: 22.2px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -9.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28574" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49.2px; left: 8.9px;"><span class="texatom" id="MathJax-Span-28575"><span class="mrow" id="MathJax-Span-28576"><span class="mo" id="MathJax-Span-28577" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-28578" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-28579" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-28580" style="font-family: STIXGeneral; padding-left: 4.3px;">−</span><span class="mi" id="MathJax-Span-28581" style="font-family: STIXGeneral; font-style: italic; padding-left: 4.3px;">μ</span><span class="msubsup" id="MathJax-Span-28582"><span style="display: inline-block; position: relative; width: 13.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 50.1px -8.5px); top: -44px; left: 0px;"><span class="mo" id="MathJax-Span-28583" style="font-family: STIXGeneral;">)</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49.2px; left: 6px;"><span class="mn" id="MathJax-Span-28584" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 51.8px; vertical-align: -22.8px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-916">\sigma^2 = \dfrac{1}{m}\displaystyle \sum_{i=1}^m(x^{(i)} - \mu)^2</script></p><h1>Algorithm</h1><p>Given a training set of examples, <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-917-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-28585"><span style="display: inline-block; position: relative; width: 103px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(26.4px 17360px 50.1px -7.3px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-28586"><span class="mo" id="MathJax-Span-28587" style="font-family: STIXGeneral;">{</span><span class="msubsup" id="MathJax-Span-28588"><span style="display: inline-block; position: relative; width: 24.2px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -9.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28589" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 8.9px;"><span class="texatom" id="MathJax-Span-28590"><span class="mrow" id="MathJax-Span-28591"><span class="mo" id="MathJax-Span-28592" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-28593" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-28594" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-28595" style="font-family: STIXGeneral;">,</span><span class="mo" id="MathJax-Span-28596" style="font-family: STIXGeneral; padding-left: 3.3px;">…</span><span class="mo" id="MathJax-Span-28597" style="font-family: STIXGeneral; padding-left: 3.3px;">,</span><span class="msubsup" id="MathJax-Span-28598" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 27.2px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -9.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28599" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 8.9px;"><span class="texatom" id="MathJax-Span-28600"><span class="mrow" id="MathJax-Span-28601"><span class="mo" id="MathJax-Span-28602" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-28603" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">m</span><span class="mo" id="MathJax-Span-28604" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-28605" style="font-family: STIXGeneral;">}</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 19.7px; vertical-align: -4.1px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-917">\lbrace x^{(1)},\dots,x^{(m)}\rbrace</script> where each example is a vector, <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-918-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-28606"><span style="display: inline-block; position: relative; width: 50px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(28.8px 17360px 47.5px -9.5px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-28607"><span class="mi" id="MathJax-Span-28608" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span class="mo" id="MathJax-Span-28609" style="font-family: STIXGeneral; padding-left: 5.4px;">∈</span><span class="msubsup" id="MathJax-Span-28610" style="padding-left: 5.4px;"><span style="display: inline-block; position: relative; width: 20.3px; height: 0px;"><span style="position: absolute; clip: rect(29.5px 17360px 47px -7.8px); top: -44px; left: 0px;"><span class="texatom" id="MathJax-Span-28611"><span class="mrow" id="MathJax-Span-28612"><span class="mi" id="MathJax-Span-28613" style="font-family: STIXGeneral;">ℝ</span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.8px; left: 13px;"><span class="mi" id="MathJax-Span-28614" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 14.6px; vertical-align: -1.5px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-918">x \in \mathbb{R}^n</script>.</p><p><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-919-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-28615"><span style="display: inline-block; position: relative; width: 325px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(26.7px 17360px 52.4px -10.3px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-28616"><span class="mi" id="MathJax-Span-28617" style="font-family: STIXGeneral; font-style: italic;">p</span><span class="mo" id="MathJax-Span-28618" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-28619" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span class="mo" id="MathJax-Span-28620" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-28621" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="mi" id="MathJax-Span-28622" style="font-family: STIXGeneral; font-style: italic; padding-left: 5.4px;">p</span><span class="mo" id="MathJax-Span-28623" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-28624"><span style="display: inline-block; position: relative; width: 15.2px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -9.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28625" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -39.4px; left: 7.9px;"><span class="mn" id="MathJax-Span-28626" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-28627" style="font-family: STIXGeneral;">;</span><span class="msubsup" id="MathJax-Span-28628" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 16.3px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 50.6px -9.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28629" style="font-family: STIXGeneral; font-style: italic;">μ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -37.8px; left: 9px;"><span class="mn" id="MathJax-Span-28630" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-28631" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-28632" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 17.3px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 47.2px -8.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28633" style="font-family: STIXGeneral; font-style: italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.6px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(30.7px 17360px 45px -8.6px); top: -48px; left: 10px;"><span class="mn" id="MathJax-Span-28634" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(30.7px 17360px 45px -7.6px); top: -36.6px; left: 8.4px;"><span class="mn" id="MathJax-Span-28635" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-28636" style="font-family: STIXGeneral;">)</span><span class="mi" id="MathJax-Span-28637" style="font-family: STIXGeneral; font-style: italic;">p</span><span class="mo" id="MathJax-Span-28638" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-28639"><span style="display: inline-block; position: relative; width: 15.2px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -9.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28640" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -39.4px; left: 7.9px;"><span class="mn" id="MathJax-Span-28641" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-28642" style="font-family: STIXGeneral;">;</span><span class="msubsup" id="MathJax-Span-28643" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 16.3px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 50.6px -9.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28644" style="font-family: STIXGeneral; font-style: italic;">μ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -37.8px; left: 9px;"><span class="mn" id="MathJax-Span-28645" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-28646" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-28647" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 17.3px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 47.2px -8.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28648" style="font-family: STIXGeneral; font-style: italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.6px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(30.7px 17360px 45px -8.6px); top: -48px; left: 10px;"><span class="mn" id="MathJax-Span-28649" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(30.7px 17360px 45px -8.6px); top: -36.6px; left: 8.4px;"><span class="mn" id="MathJax-Span-28650" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-28651" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-28652" style="font-family: STIXGeneral; padding-left: 3.3px;">⋯</span><span class="mi" id="MathJax-Span-28653" style="font-family: STIXGeneral; font-style: italic; padding-left: 3.3px;">p</span><span class="mo" id="MathJax-Span-28654" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-28655"><span style="display: inline-block; position: relative; width: 15.2px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -9.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28656" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -39.4px; left: 7.9px;"><span class="mi" id="MathJax-Span-28657" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-28658" style="font-family: STIXGeneral;">;</span><span class="msubsup" id="MathJax-Span-28659" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 16.3px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 50.6px -9.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28660" style="font-family: STIXGeneral; font-style: italic;">μ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -37.8px; left: 9px;"><span class="mi" id="MathJax-Span-28661" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-28662" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-28663" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 17.3px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 47.2px -8.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28664" style="font-family: STIXGeneral; font-style: italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.6px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(30.7px 17360px 45px -8.6px); top: -48px; left: 10px;"><span class="mn" id="MathJax-Span-28665" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(33.6px 17360px 45.1px -8.8px); top: -39.4px; left: 8.4px;"><span class="mi" id="MathJax-Span-28666" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-28667" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 21.7px; vertical-align: -6.4px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-919">p(x) = p(x_1;\mu_1,\sigma_1^2)p(x_2;\mu_2,\sigma^2_2)\cdots p(x_n;\mu_n,\sigma^2_n)</script></p><p>In statistics, this is called an "independence assumption" on the values of the features inside training example x.</p><p>More compactly, the above expression can be written as follows:</p><p><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-920-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-28668"><span style="display: inline-block; position: relative; width: 122px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(13px 17360px 71.2px -8.2px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-28669"><span class="mo" id="MathJax-Span-28670" style="font-family: STIXGeneral;">=</span><span class="mstyle" id="MathJax-Span-28671" style="padding-left: 5.4px;"><span class="mrow" id="MathJax-Span-28672"><span class="munderover" id="MathJax-Span-28673"><span style="display: inline-block; position: relative; width: 24px; height: 0px;"><span style="position: absolute; clip: rect(31.1px 17360px 62.3px -8.1px); top: -51px; left: 0px;"><span class="mo" id="MathJax-Span-28674" style="font-family: STIXSizeOneSym; vertical-align: -9.1px;">∏</span><span style="display: inline-block; width: 0px; height: 51px;"></span></span><span style="position: absolute; clip: rect(30.7px 17360px 49.3px -10.5px); top: -22px; left: 3px;"><span class="texatom" id="MathJax-Span-28675"><span class="mrow" id="MathJax-Span-28676"><span class="mi" id="MathJax-Span-28677" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-28678" style="font-size: 70.7%; font-family: STIXGeneral;">=</span><span class="mn" id="MathJax-Span-28679" style="font-size: 70.7%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(31.9px 17360px 45.1px -8.8px); top: -62.8px; left: 9px;"><span class="mi" id="MathJax-Span-28680" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mi" id="MathJax-Span-28681" style="font-family: STIXGeneral; font-style: italic; padding-left: 3.3px;">p</span><span class="mo" id="MathJax-Span-28682" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-28683"><span style="display: inline-block; position: relative; width: 12.2px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -9.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28684" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -39.4px; left: 7.9px;"><span class="mi" id="MathJax-Span-28685" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-28686" style="font-family: STIXGeneral;">;</span><span class="msubsup" id="MathJax-Span-28687" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 13.3px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 50.6px -9.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28688" style="font-family: STIXGeneral; font-style: italic;">μ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -37.8px; left: 9px;"><span class="mi" id="MathJax-Span-28689" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-28690" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-28691" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 17.3px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 47.2px -8.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28692" style="font-family: STIXGeneral; font-style: italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.6px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(30.7px 17360px 45px -8.6px); top: -48px; left: 10px;"><span class="mn" id="MathJax-Span-28693" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(31px 17360px 47.5px -10.5px); top: -36.9px; left: 8.4px;"><span class="mi" id="MathJax-Span-28694" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-28695" style="font-family: STIXGeneral;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 54.2px; vertical-align: -25.2px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-920">= \displaystyle \prod^n_{j=1} p(x_j;\mu_j,\sigma_j^2)</script></p><p><strong>The algorithm</strong></p><p>Choose features <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-921-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-28696"><span style="display: inline-block; position: relative; width: 12px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(30.3px 17360px 46.7px -9.5px); top: -41px; left: 0px;"><span class="mrow" id="MathJax-Span-28697"><span class="msubsup" id="MathJax-Span-28698"><span style="display: inline-block; position: relative; width: 12.2px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -9.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28699" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -39.4px; left: 7.9px;"><span class="mi" id="MathJax-Span-28700" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 12.4px; vertical-align: -3.7px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-921">x_i</script> that you think might be indicative of anomalous examples.</p><p>Fit parameters <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-922-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-28701"><span style="display: inline-block; position: relative; width: 145px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(26.7px 17360px 52.4px -9.6px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-28702"><span class="msubsup" id="MathJax-Span-28703"><span style="display: inline-block; position: relative; width: 16.3px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 50.6px -9.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28704" style="font-family: STIXGeneral; font-style: italic;">μ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -37.8px; left: 9px;"><span class="mn" id="MathJax-Span-28705" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-28706" style="font-family: STIXGeneral;">,</span><span class="mo" id="MathJax-Span-28707" style="font-family: STIXGeneral; padding-left: 3.3px;">…</span><span class="mo" id="MathJax-Span-28708" style="font-family: STIXGeneral; padding-left: 3.3px;">,</span><span class="msubsup" id="MathJax-Span-28709" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 16.3px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 50.6px -9.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28710" style="font-family: STIXGeneral; font-style: italic;">μ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -37.8px; left: 9px;"><span class="mi" id="MathJax-Span-28711" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-28712" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-28713" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 17.3px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 47.2px -8.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28714" style="font-family: STIXGeneral; font-style: italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.6px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(30.7px 17360px 45px -8.6px); top: -48px; left: 10px;"><span class="mn" id="MathJax-Span-28715" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(30.7px 17360px 45px -7.6px); top: -36.6px; left: 8.4px;"><span class="mn" id="MathJax-Span-28716" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-28717" style="font-family: STIXGeneral;">,</span><span class="mo" id="MathJax-Span-28718" style="font-family: STIXGeneral; padding-left: 3.3px;">…</span><span class="mo" id="MathJax-Span-28719" style="font-family: STIXGeneral; padding-left: 3.3px;">,</span><span class="msubsup" id="MathJax-Span-28720" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 17.3px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 47.2px -8.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28721" style="font-family: STIXGeneral; font-style: italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.6px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(30.7px 17360px 45px -8.6px); top: -48px; left: 10px;"><span class="mn" id="MathJax-Span-28722" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(33.6px 17360px 45.1px -8.8px); top: -39.4px; left: 8.4px;"><span class="mi" id="MathJax-Span-28723" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 21.7px; vertical-align: -6.4px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-922">\mu_1,\dots,\mu_n,\sigma_1^2,\dots,\sigma_n^2</script></p><p>Calculate <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-923-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-28724"><span style="display: inline-block; position: relative; width: 104px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(13px 17360px 68.8px -9.6px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-28725"><span class="msubsup" id="MathJax-Span-28726"><span style="display: inline-block; position: relative; width: 13.3px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 50.6px -9.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28727" style="font-family: STIXGeneral; font-style: italic;">μ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -37.8px; left: 9px;"><span class="mi" id="MathJax-Span-28728" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-28729" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="mstyle" id="MathJax-Span-28730" style="padding-left: 5.4px;"><span class="mrow" id="MathJax-Span-28731"><span class="mfrac" id="MathJax-Span-28732" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 15.1px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 47px -7.1px); top: -55.7px; left: 50%; margin-left: -4.5px;"><span class="mn" id="MathJax-Span-28733" style="font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.8px); top: -32.1px; left: 50%; margin-left: -6.5px;"><span class="mi" id="MathJax-Span-28734" style="font-family: STIXGeneral; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 15.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span></span></span><span class="mstyle" id="MathJax-Span-28735" style="padding-left: 3.3px;"><span class="mrow" id="MathJax-Span-28736"><span class="munderover" id="MathJax-Span-28737"><span style="display: inline-block; position: relative; width: 22px; height: 0px;"><span style="position: absolute; clip: rect(31.1px 17360px 62.2px -7.4px); top: -51px; left: 0px;"><span class="mo" id="MathJax-Span-28738" style="font-family: STIXSizeOneSym; vertical-align: -9.1px;">∑</span><span style="display: inline-block; width: 0px; height: 51px;"></span></span><span style="position: absolute; clip: rect(30.7px 17360px 46.9px -8.4px); top: -22px; left: 2px;"><span class="texatom" id="MathJax-Span-28739"><span class="mrow" id="MathJax-Span-28740"><span class="mi" id="MathJax-Span-28741" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-28742" style="font-size: 70.7%; font-family: STIXGeneral;">=</span><span class="mn" id="MathJax-Span-28743" style="font-size: 70.7%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(31.9px 17360px 45.1px -8.9px); top: -62.8px; left: 6.5px;"><span class="mi" id="MathJax-Span-28744" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="msubsup" id="MathJax-Span-28745" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 22.2px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -9.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28746" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(30.7px 17360px 47.2px -8.4px); top: -50.2px; left: 8.9px;"><span class="texatom" id="MathJax-Span-28747"><span class="mrow" id="MathJax-Span-28748"><span class="mo" id="MathJax-Span-28749" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-28750" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-28751" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(31px 17360px 47.5px -10.5px); top: -36.9px; left: 7.9px;"><span class="mi" id="MathJax-Span-28752" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 51.8px; vertical-align: -22.8px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-923">\mu_j = \dfrac{1}{m}\displaystyle \sum_{i=1}^m x_j^{(i)}</script></p><p>Calculate <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-924-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-28753"><span style="display: inline-block; position: relative; width: 158px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(13px 17360px 68.8px -8.5px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-28754"><span class="msubsup" id="MathJax-Span-28755"><span style="display: inline-block; position: relative; width: 17.3px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 47.2px -8.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28756" style="font-family: STIXGeneral; font-style: italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.6px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(30.7px 17360px 45px -8.6px); top: -48px; left: 10px;"><span class="mn" id="MathJax-Span-28757" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(31px 17360px 47.5px -10.5px); top: -36.9px; left: 8.4px;"><span class="mi" id="MathJax-Span-28758" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-28759" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="mstyle" id="MathJax-Span-28760" style="padding-left: 5.4px;"><span class="mrow" id="MathJax-Span-28761"><span class="mfrac" id="MathJax-Span-28762" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 15.1px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 47px -7.1px); top: -55.7px; left: 50%; margin-left: -4.5px;"><span class="mn" id="MathJax-Span-28763" style="font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.8px); top: -32.1px; left: 50%; margin-left: -6.5px;"><span class="mi" id="MathJax-Span-28764" style="font-family: STIXGeneral; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 15.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span></span></span><span class="mstyle" id="MathJax-Span-28765" style="padding-left: 3.3px;"><span class="mrow" id="MathJax-Span-28766"><span class="munderover" id="MathJax-Span-28767"><span style="display: inline-block; position: relative; width: 22px; height: 0px;"><span style="position: absolute; clip: rect(31.1px 17360px 62.2px -7.4px); top: -51px; left: 0px;"><span class="mo" id="MathJax-Span-28768" style="font-family: STIXSizeOneSym; vertical-align: -9.1px;">∑</span><span style="display: inline-block; width: 0px; height: 51px;"></span></span><span style="position: absolute; clip: rect(30.7px 17360px 46.9px -8.4px); top: -22px; left: 2px;"><span class="texatom" id="MathJax-Span-28769"><span class="mrow" id="MathJax-Span-28770"><span class="mi" id="MathJax-Span-28771" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-28772" style="font-size: 70.7%; font-family: STIXGeneral;">=</span><span class="mn" id="MathJax-Span-28773" style="font-size: 70.7%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(31.9px 17360px 45.1px -8.9px); top: -62.8px; left: 6.5px;"><span class="mi" id="MathJax-Span-28774" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-28775" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-28776"><span style="display: inline-block; position: relative; width: 22.2px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -9.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28777" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(30.7px 17360px 47.2px -8.4px); top: -50.2px; left: 8.9px;"><span class="texatom" id="MathJax-Span-28778"><span class="mrow" id="MathJax-Span-28779"><span class="mo" id="MathJax-Span-28780" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-28781" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-28782" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(31px 17360px 47.5px -10.5px); top: -36.9px; left: 7.9px;"><span class="mi" id="MathJax-Span-28783" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-28784" style="font-family: STIXGeneral; padding-left: 4.3px;">−</span><span class="msubsup" id="MathJax-Span-28785" style="padding-left: 4.3px;"><span style="display: inline-block; position: relative; width: 13.3px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 50.6px -9.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28786" style="font-family: STIXGeneral; font-style: italic;">μ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -37.8px; left: 9px;"><span class="mi" id="MathJax-Span-28787" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="msubsup" id="MathJax-Span-28788"><span style="display: inline-block; position: relative; width: 13.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 50.1px -8.5px); top: -44px; left: 0px;"><span class="mo" id="MathJax-Span-28789" style="font-family: STIXGeneral;">)</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49.2px; left: 6px;"><span class="mn" id="MathJax-Span-28790" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 51.8px; vertical-align: -22.8px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-924">\sigma^2_j = \dfrac{1}{m}\displaystyle \sum_{i=1}^m(x_j^{(i)} - \mu_j)^2</script></p><p>Given a new example x, compute p(x):</p><p><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-925-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-28791"><span style="display: inline-block; position: relative; width: 378px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(10.6px 17360px 71.2px -10.3px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-28792"><span class="mi" id="MathJax-Span-28793" style="font-family: STIXGeneral; font-style: italic;">p</span><span class="mo" id="MathJax-Span-28794" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-28795" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span class="mo" id="MathJax-Span-28796" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-28797" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="mstyle" id="MathJax-Span-28798" style="padding-left: 5.4px;"><span class="mrow" id="MathJax-Span-28799"><span class="munderover" id="MathJax-Span-28800"><span style="display: inline-block; position: relative; width: 24px; height: 0px;"><span style="position: absolute; clip: rect(31.1px 17360px 62.3px -8.1px); top: -51px; left: 0px;"><span class="mo" id="MathJax-Span-28801" style="font-family: STIXSizeOneSym; vertical-align: -9.1px;">∏</span><span style="display: inline-block; width: 0px; height: 51px;"></span></span><span style="position: absolute; clip: rect(30.7px 17360px 49.3px -10.5px); top: -22px; left: 3px;"><span class="texatom" id="MathJax-Span-28802"><span class="mrow" id="MathJax-Span-28803"><span class="mi" id="MathJax-Span-28804" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-28805" style="font-size: 70.7%; font-family: STIXGeneral;">=</span><span class="mn" id="MathJax-Span-28806" style="font-size: 70.7%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(31.9px 17360px 45.1px -8.8px); top: -62.8px; left: 9px;"><span class="mi" id="MathJax-Span-28807" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mi" id="MathJax-Span-28808" style="font-family: STIXGeneral; font-style: italic; padding-left: 3.3px;">p</span><span class="mo" id="MathJax-Span-28809" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-28810"><span style="display: inline-block; position: relative; width: 12.2px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -9.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28811" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -39.4px; left: 7.9px;"><span class="mi" id="MathJax-Span-28812" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-28813" style="font-family: STIXGeneral;">;</span><span class="msubsup" id="MathJax-Span-28814" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 13.3px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 50.6px -9.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28815" style="font-family: STIXGeneral; font-style: italic;">μ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -37.8px; left: 9px;"><span class="mi" id="MathJax-Span-28816" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-28817" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-28818" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 17.3px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 47.2px -8.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28819" style="font-family: STIXGeneral; font-style: italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.6px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(30.7px 17360px 45px -8.6px); top: -48px; left: 10px;"><span class="mn" id="MathJax-Span-28820" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(31px 17360px 47.5px -10.5px); top: -36.9px; left: 8.4px;"><span class="mi" id="MathJax-Span-28821" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-28822" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-28823" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="munderover" id="MathJax-Span-28824" style="padding-left: 5.4px;"><span style="display: inline-block; position: relative; width: 24px; height: 0px;"><span style="position: absolute; clip: rect(31.1px 17360px 62.3px -8.1px); top: -51px; left: 0px;"><span class="mo" id="MathJax-Span-28825" style="font-family: STIXSizeOneSym; vertical-align: -9.1px;">∏</span><span style="display: inline-block; width: 0px; height: 51px;"></span></span><span style="position: absolute; clip: rect(30.7px 17360px 49.3px -10.5px); top: -22px; left: 3px;"><span class="texatom" id="MathJax-Span-28826"><span class="mrow" id="MathJax-Span-28827"><span class="mi" id="MathJax-Span-28828" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-28829" style="font-size: 70.7%; font-family: STIXGeneral;">=</span><span class="mn" id="MathJax-Span-28830" style="font-size: 70.7%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(31.9px 17360px 45.1px -8.8px); top: -62.8px; left: 9px;"><span class="mi" id="MathJax-Span-28831" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mstyle" id="MathJax-Span-28832" style="padding-left: 3.3px;"><span class="mrow" id="MathJax-Span-28833"><span class="mfrac" id="MathJax-Span-28834" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 46.2px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 47px -7.1px); top: -55.7px; left: 50%; margin-left: -4.5px;"><span class="mn" id="MathJax-Span-28835" style="font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(51.7px 17360px 77.1px -7.8px); top: -55px; left: 50%; margin-left: -22.1px;"><span class="mrow" id="MathJax-Span-28836"><span class="msqrt" id="MathJax-Span-28837"><span style="display: inline-block; position: relative; width: 31.4px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 47.3px -8.5px); top: -44px; left: 13px;"><span class="mrow" id="MathJax-Span-28838"><span class="mn" id="MathJax-Span-28839" style="font-family: STIXGeneral;">2</span><span class="mi" id="MathJax-Span-28840" style="font-family: STIXGeneral; font-style: italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.6px;"></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(51.8px 17360px 58.6px -9px); top: -69px; left: 13px;"><span style="display: inline-block; position: relative; width: 18.4px; height: 0px;"><span style="position: absolute; font-family: STIXGeneral; top: -69px; left: 0px;">‾<span style="display: inline-block; width: 0px; height: 69px;"></span></span><span style="position: absolute; font-family: STIXGeneral; top: -69px; left: 9.8px;">‾<span style="display: inline-block; width: 0px; height: 69px;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -69px; left: 4.7px;">‾<span style="display: inline-block; width: 0px; height: 69px;"></span></span></span><span style="display: inline-block; width: 0px; height: 69px;"></span></span><span style="position: absolute; clip: rect(49.6px 17360px 72.2px -7.8px); top: -66.7px; left: 0px;"><span style="font-family: STIXVariants;">√</span><span style="display: inline-block; width: 0px; height: 69px;"></span></span></span></span><span class="msubsup" id="MathJax-Span-28841"><span style="display: inline-block; position: relative; width: 12.7px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 47.2px -8.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28842" style="font-family: STIXGeneral; font-style: italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.6px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -39.4px; left: 8.4px;"><span class="mi" id="MathJax-Span-28843" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 69px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 46.2px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span></span></span><span class="mi" id="MathJax-Span-28844" style="font-family: STIXGeneral; font-style: italic; padding-left: 3.3px;">e</span><span class="mi" id="MathJax-Span-28845" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span class="mi" id="MathJax-Span-28846" style="font-family: STIXGeneral; font-style: italic;">p</span><span class="mo" id="MathJax-Span-28847" style="font-family: STIXGeneral;">(</span><span class="mo" id="MathJax-Span-28848" style="font-family: STIXGeneral;">−</span><span class="mstyle" id="MathJax-Span-28849" style="padding-left: 3.3px;"><span class="mrow" id="MathJax-Span-28850"><span class="mfrac" id="MathJax-Span-28851" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 66.1px; height: 0px;"><span style="position: absolute; clip: rect(25.7px 17360px 53.7px -8.2px); top: -59.1px; left: 50%; margin-left: -32px;"><span class="mrow" id="MathJax-Span-28852"><span class="mo" id="MathJax-Span-28853" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-28854"><span style="display: inline-block; position: relative; width: 12.2px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -9.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28855" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -39.4px; left: 7.9px;"><span class="mi" id="MathJax-Span-28856" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-28857" style="font-family: STIXGeneral; padding-left: 4.3px;">−</span><span class="msubsup" id="MathJax-Span-28858" style="padding-left: 4.3px;"><span style="display: inline-block; position: relative; width: 13.3px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 50.6px -9.6px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28859" style="font-family: STIXGeneral; font-style: italic;">μ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -37.8px; left: 9px;"><span class="mi" id="MathJax-Span-28860" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="msubsup" id="MathJax-Span-28861"><span style="display: inline-block; position: relative; width: 13.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 50.1px -8.5px); top: -44px; left: 0px;"><span class="mo" id="MathJax-Span-28862" style="font-family: STIXGeneral;">)</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49px; left: 6px;"><span class="mn" id="MathJax-Span-28863" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(26.7px 17360px 54.7px -8.5px); top: -30px; left: 50%; margin-left: -13px;"><span class="mrow" id="MathJax-Span-28864"><span class="mn" id="MathJax-Span-28865" style="font-family: STIXGeneral;">2</span><span class="msubsup" id="MathJax-Span-28866"><span style="display: inline-block; position: relative; width: 17.3px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 47.2px -8.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28867" style="font-family: STIXGeneral; font-style: italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.6px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(30.7px 17360px 45px -8.6px); top: -48px; left: 10px;"><span class="mn" id="MathJax-Span-28868" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(31px 17360px 47.5px -10.5px); top: -36.9px; left: 8.4px;"><span class="mi" id="MathJax-Span-28869" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 66.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-28870" style="font-family: STIXGeneral;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 56.7px; vertical-align: -25.2px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-925">p(x) = \displaystyle \prod^n_{j=1} p(x_j;\mu_j,\sigma_j^2) = \prod\limits^n_{j=1} \dfrac{1}{\sqrt{2\pi}\sigma_j}exp(-\dfrac{(x_j - \mu_j)^2}{2\sigma^2_j})</script></p><p>Anomaly if p(x)&lt;ϵ</p><p>A vectorized version of the calculation for μ is <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-926-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-28871"><span style="display: inline-block; position: relative; width: 100px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(13px 17360px 68.8px -9.6px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-28872"><span class="mi" id="MathJax-Span-28873" style="font-family: STIXGeneral; font-style: italic;">μ</span><span class="mo" id="MathJax-Span-28874" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="mstyle" id="MathJax-Span-28875" style="padding-left: 5.4px;"><span class="mrow" id="MathJax-Span-28876"><span class="mfrac" id="MathJax-Span-28877" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 15.1px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 47px -7.1px); top: -55.7px; left: 50%; margin-left: -4.5px;"><span class="mn" id="MathJax-Span-28878" style="font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.8px); top: -32.1px; left: 50%; margin-left: -6.5px;"><span class="mi" id="MathJax-Span-28879" style="font-family: STIXGeneral; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 15.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span></span></span><span class="mstyle" id="MathJax-Span-28880" style="padding-left: 3.3px;"><span class="mrow" id="MathJax-Span-28881"><span class="munderover" id="MathJax-Span-28882"><span style="display: inline-block; position: relative; width: 22px; height: 0px;"><span style="position: absolute; clip: rect(31.1px 17360px 62.2px -7.4px); top: -51px; left: 0px;"><span class="mo" id="MathJax-Span-28883" style="font-family: STIXSizeOneSym; vertical-align: -9.1px;">∑</span><span style="display: inline-block; width: 0px; height: 51px;"></span></span><span style="position: absolute; clip: rect(30.7px 17360px 46.9px -8.4px); top: -22px; left: 2px;"><span class="texatom" id="MathJax-Span-28884"><span class="mrow" id="MathJax-Span-28885"><span class="mi" id="MathJax-Span-28886" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-28887" style="font-size: 70.7%; font-family: STIXGeneral;">=</span><span class="mn" id="MathJax-Span-28888" style="font-size: 70.7%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(31.9px 17360px 45.1px -8.9px); top: -62.8px; left: 6.5px;"><span class="mi" id="MathJax-Span-28889" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="msubsup" id="MathJax-Span-28890" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 22.2px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -9.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28891" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49.2px; left: 8.9px;"><span class="texatom" id="MathJax-Span-28892"><span class="mrow" id="MathJax-Span-28893"><span class="mo" id="MathJax-Span-28894" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-28895" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-28896" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 51.8px; vertical-align: -22.8px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-926">\mu = \dfrac{1}{m}\displaystyle \sum_{i=1}^m x^{(i)}</script>. You can vectorize <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-927-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-28897"><span style="display: inline-block; position: relative; width: 17px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(23.4px 17360px 44.2px -8.5px); top: -41px; left: 0px;"><span class="mrow" id="MathJax-Span-28898"><span class="msubsup" id="MathJax-Span-28899"><span style="display: inline-block; position: relative; width: 17.3px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 47.2px -8.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28900" style="font-family: STIXGeneral; font-style: italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.6px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 10px;"><span class="mn" id="MathJax-Span-28901" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 16.8px; vertical-align: -1.2px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-927">\sigma^2</script> similarly.</p><h1>Developing and Evaluating an Anomaly Detection System</h1><p>To evaluate our learning algorithm, we take some labeled data, categorized into anomalous and non-anomalous examples ( y = 0 if normal, y = 1 if anomalous).</p><p>Among that data, take a large proportion of <strong>good</strong>, non-anomalous data for the training set on which to train p(x).</p><p>Then, take a smaller proportion of mixed anomalous and non-anomalous examples (you will usually have many more non-anomalous examples) for your cross-validation and test sets.</p><p>For example, we may have a set where 0.2% of the data is anomalous. We take 60% of those examples, all of which are good (y=0) for the training set. We then take 20% of the examples for the cross-validation set (with 0.1% of the anomalous examples) and another 20% from the test set (with another 0.1% of the anomalous).</p><p>In other words, we split the data 60/20/20 training/CV/test and then split the anomalous examples 50/50 between the CV and test sets.</p><p><strong>Algorithm evaluation:</strong></p><p>Fit model p(x) on training set <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-928-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-28902"><span style="display: inline-block; position: relative; width: 103px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(26.4px 17360px 50.1px -7.3px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-28903"><span class="mo" id="MathJax-Span-28904" style="font-family: STIXGeneral;">{</span><span class="msubsup" id="MathJax-Span-28905"><span style="display: inline-block; position: relative; width: 24.2px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -9.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28906" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 8.9px;"><span class="texatom" id="MathJax-Span-28907"><span class="mrow" id="MathJax-Span-28908"><span class="mo" id="MathJax-Span-28909" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-28910" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-28911" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-28912" style="font-family: STIXGeneral;">,</span><span class="mo" id="MathJax-Span-28913" style="font-family: STIXGeneral; padding-left: 3.3px;">…</span><span class="mo" id="MathJax-Span-28914" style="font-family: STIXGeneral; padding-left: 3.3px;">,</span><span class="msubsup" id="MathJax-Span-28915" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 27.2px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -9.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28916" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 8.9px;"><span class="texatom" id="MathJax-Span-28917"><span class="mrow" id="MathJax-Span-28918"><span class="mo" id="MathJax-Span-28919" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-28920" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">m</span><span class="mo" id="MathJax-Span-28921" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-28922" style="font-family: STIXGeneral;">}</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 19.7px; vertical-align: -4.1px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-928">\lbrace x^{(1)},\dots,x^{(m)} \rbrace</script></p><p>On a cross validation/test example x, predict:</p><p>If p(x) &lt; ϵ (<strong>anomaly</strong>), then y=1</p><p>If p(x) ≥ ϵ (<strong>normal</strong>), then y=0</p><p>Possible evaluation metrics (see "Machine Learning System Design" section):</p><ul><li>True positive, false positive, false negative, true negative.</li><li>Precision/recall</li><li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-929-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-28923"><span style="display: inline-block; position: relative; width: 18px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(26.7px 17360px 46.6px -8.9px); top: -41px; left: 0px;"><span class="mrow" id="MathJax-Span-28924"><span class="msubsup" id="MathJax-Span-28925"><span style="display: inline-block; position: relative; width: 17.7px; height: 0px;"><span style="position: absolute; clip: rect(29.7px 17360px 47px -8.9px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28926" style="font-family: STIXGeneral; font-style: italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.6px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -39.4px; left: 10.4px;"><span class="mn" id="MathJax-Span-28927" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 15.9px; vertical-align: -3.6px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-929">F_1</script> score</li></ul><p>Note that we use the cross-validation set to choose parameter ϵ</p><h1>Anomaly Detection vs. Supervised Learning</h1><p>When do we use anomaly detection and when do we use supervised learning?</p><p>Use anomaly detection when...</p><ul><li>We have a very small number of positive examples (y=1 ... 0-20 examples is common) and a large number of negative (y=0) examples.</li><li>We have many different "types" of anomalies and it is hard for any algorithm to learn from positive examples what the anomalies look like; future anomalies may look nothing like any of the anomalous examples we've seen so far.</li></ul><p>Use supervised learning when...</p><ul><li>We have a large number of both positive and negative examples. In other words, the training set is more evenly divided into classes.</li><li>We have enough positive examples for the algorithm to get a sense of what new positives examples look like. The future positive examples are likely similar to the ones in the training set.</li></ul><h1>Choosing What Features to Use</h1><p>The features will greatly affect how well your anomaly detection algorithm works.</p><p>We can check that our features are <strong>gaussian</strong> by plotting a histogram of our data and checking for the bell-shaped curve.</p><p>Some <strong>transforms</strong> we can try on an example feature x that does not have the bell-shaped curve are:</p><ul><li>log(x)</li><li>log(x+1)</li><li>log(x+c) for some constant</li><li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-930-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-28928"><span style="display: inline-block; position: relative; width: 21px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(25.7px 17360px 48.4px -7.8px); top: -41px; left: 0px;"><span class="mrow" id="MathJax-Span-28929"><span class="msqrt" id="MathJax-Span-28930"><span style="display: inline-block; position: relative; width: 21px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -9.5px); top: -44px; left: 13px;"><span class="mrow" id="MathJax-Span-28931"><span class="mi" id="MathJax-Span-28932" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(16px 17360px 23.2px -9px); top: -31.3px; left: 13px;"><span style="border-left: 8px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: -1.3px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span><span style="position: absolute; clip: rect(49.6px 17360px 72.2px -7.8px); top: -64.7px; left: 0px;"><span style="font-family: STIXVariants;">√</span><span style="display: inline-block; width: 0px; height: 69px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 18.7px; vertical-align: -5.4px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-930">\sqrt{x}</script></li><li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-931-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-28933"><span style="display: inline-block; position: relative; width: 26px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(23.4px 17360px 44.2px -9.5px); top: -41px; left: 0px;"><span class="mrow" id="MathJax-Span-28934"><span class="msubsup" id="MathJax-Span-28935"><span style="display: inline-block; position: relative; width: 26.2px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -9.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28936" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 8.9px;"><span class="texatom" id="MathJax-Span-28937"><span class="mrow" id="MathJax-Span-28938"><span class="mn" id="MathJax-Span-28939" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="texatom" id="MathJax-Span-28940"><span class="mrow" id="MathJax-Span-28941"><span class="mo" id="MathJax-Span-28942" style="font-size: 70.7%; font-family: STIXGeneral;">/</span></span></span><span class="mn" id="MathJax-Span-28943" style="font-size: 70.7%; font-family: STIXGeneral;">3</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 16.8px; vertical-align: -1.2px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-931">x^{1/3}</script></li></ul><p>We can play with each of these to try and achieve the gaussian shape in our data.</p><p>There is an <strong>error analysis procedure</strong> for anomaly detection that is very similar to the one in supervised learning.</p><p>Our goal is for p(x) to be large for normal examples and small for anomalous examples.</p><p>One common problem is when p(x) is similar for both types of examples. In this case, you need to examine the anomalous examples that are giving high probability in detail and try to figure out new features that will better distinguish the data.</p><p>In general, choose features that might take on unusually large or small values in the event of an anomaly.</p><h1>Multivariate Gaussian Distribution (Optional)</h1><p>The multivariate gaussian distribution is an extension of anomaly detection and may (or may not) catch more anomalies.</p><p>Instead of modeling <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-932-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-28944"><span style="display: inline-block; position: relative; width: 103px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(29.3px 17360px 50.6px -10.3px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-28945"><span class="mi" id="MathJax-Span-28946" style="font-family: STIXGeneral; font-style: italic;">p</span><span class="mo" id="MathJax-Span-28947" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-28948"><span style="display: inline-block; position: relative; width: 15.2px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -9.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28949" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -39.4px; left: 7.9px;"><span class="mn" id="MathJax-Span-28950" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-28951" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-28952" style="font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-28953" style="font-family: STIXGeneral; font-style: italic; padding-left: 3.3px;">p</span><span class="mo" id="MathJax-Span-28954" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-28955"><span style="display: inline-block; position: relative; width: 15.2px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -9.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-28956" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -39.4px; left: 7.9px;"><span class="mn" id="MathJax-Span-28957" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-28958" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-28959" style="font-family: STIXGeneral;">,</span><span class="mo" id="MathJax-Span-28960" style="font-family: STIXGeneral; padding-left: 3.3px;">…</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 17.3px; vertical-align: -4.6px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-932">p(x_1),p(x_2),\dots</script> separately, we will model p(x) all in one go. Our parameters will be: <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-933-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-28961"><span style="display: inline-block; position: relative; width: 51px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(28.8px 17360px 50.6px -9.6px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-28962"><span class="mi" id="MathJax-Span-28963" style="font-family: STIXGeneral; font-style: italic;">μ</span><span class="mo" id="MathJax-Span-28964" style="font-family: STIXGeneral; padding-left: 5.4px;">∈</span><span class="msubsup" id="MathJax-Span-28965" style="padding-left: 5.4px;"><span style="display: inline-block; position: relative; width: 20.3px; height: 0px;"><span style="position: absolute; clip: rect(29.5px 17360px 47px -7.8px); top: -44px; left: 0px;"><span class="texatom" id="MathJax-Span-28966"><span class="mrow" id="MathJax-Span-28967"><span class="mi" id="MathJax-Span-28968" style="font-family: STIXGeneral;">ℝ</span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.8px; left: 13px;"><span class="mi" id="MathJax-Span-28969" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 17.7px; vertical-align: -4.6px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-933">\mu \in \mathbb{R}^n</script> and <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-934-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-28970"><span style="display: inline-block; position: relative; width: 67px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(27.8px 17360px 47.5px -8.5px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-28971"><span class="mi" id="MathJax-Span-28972" style="font-family: STIXGeneral;">Σ</span><span class="mo" id="MathJax-Span-28973" style="font-family: STIXGeneral; padding-left: 5.4px;">∈</span><span class="msubsup" id="MathJax-Span-28974" style="padding-left: 5.4px;"><span style="display: inline-block; position: relative; width: 34.3px; height: 0px;"><span style="position: absolute; clip: rect(29.5px 17360px 47px -7.8px); top: -44px; left: 0px;"><span class="texatom" id="MathJax-Span-28975"><span class="mrow" id="MathJax-Span-28976"><span class="mi" id="MathJax-Span-28977" style="font-family: STIXGeneral;">ℝ</span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.8px; left: 13px;"><span class="texatom" id="MathJax-Span-28978"><span class="mrow" id="MathJax-Span-28979"><span class="mi" id="MathJax-Span-28980" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">n</span><span class="mo" id="MathJax-Span-28981" style="font-size: 70.7%; font-family: STIXGeneral;">×</span><span class="mi" id="MathJax-Span-28982" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 15.7px; vertical-align: -1.5px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-934">\Sigma \in \mathbb{R}^{n \times n}</script></p><p><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-935-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-28983"><span style="display: inline-block; position: relative; width: 379px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(17.5px 17360px 65.1px -10.3px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-28984"><span class="mi" id="MathJax-Span-28985" style="font-family: STIXGeneral; font-style: italic;">p</span><span class="mo" id="MathJax-Span-28986" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-28987" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span class="mo" id="MathJax-Span-28988" style="font-family: STIXGeneral;">;</span><span class="mi" id="MathJax-Span-28989" style="font-family: STIXGeneral; font-style: italic; padding-left: 3.3px;">μ</span><span class="mo" id="MathJax-Span-28990" style="font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-28991" style="font-family: STIXGeneral; padding-left: 3.3px;">Σ</span><span class="mo" id="MathJax-Span-28992" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-28993" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="mstyle" id="MathJax-Span-28994" style="padding-left: 5.4px;"><span class="mrow" id="MathJax-Span-28995"><span class="mfrac" id="MathJax-Span-28996" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 84.1px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 47px -7.1px); top: -55.7px; left: 50%; margin-left: -4.5px;"><span class="mn" id="MathJax-Span-28997" style="font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(25.7px 17360px 50.1px -8.2px); top: -29px; left: 50%; margin-left: -41px;"><span class="mrow" id="MathJax-Span-28998"><span class="mo" id="MathJax-Span-28999" style="font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-29000" style="font-family: STIXGeneral;">2</span><span class="mi" id="MathJax-Span-29001" style="font-family: STIXGeneral; font-style: italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.6px;"></span></span><span class="msubsup" id="MathJax-Span-29002"><span style="display: inline-block; position: relative; width: 23.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 50.1px -8.5px); top: -44px; left: 0px;"><span class="mo" id="MathJax-Span-29003" style="font-family: STIXGeneral;">)</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49px; left: 6px;"><span class="texatom" id="MathJax-Span-29004"><span class="mrow" id="MathJax-Span-29005"><span class="mi" id="MathJax-Span-29006" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">n</span><span class="texatom" id="MathJax-Span-29007"><span class="mrow" id="MathJax-Span-29008"><span class="mo" id="MathJax-Span-29009" style="font-size: 70.7%; font-family: STIXGeneral;">/</span></span></span><span class="mn" id="MathJax-Span-29010" style="font-size: 70.7%; font-family: STIXGeneral;">2</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="texatom" id="MathJax-Span-29011"><span class="mrow" id="MathJax-Span-29012"><span class="mo" id="MathJax-Span-29013" style="font-family: STIXGeneral;">|</span></span></span><span class="mi" id="MathJax-Span-29014" style="font-family: STIXGeneral;">Σ</span><span class="msubsup" id="MathJax-Span-29015"><span style="display: inline-block; position: relative; width: 20.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 47.2px -7.8px); top: -44px; left: 0px;"><span class="texatom" id="MathJax-Span-29016"><span class="mrow" id="MathJax-Span-29017"><span class="mo" id="MathJax-Span-29018" style="font-family: STIXGeneral;">|</span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49px; left: 3px;"><span class="texatom" id="MathJax-Span-29019"><span class="mrow" id="MathJax-Span-29020"><span class="mn" id="MathJax-Span-29021" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="texatom" id="MathJax-Span-29022"><span class="mrow" id="MathJax-Span-29023"><span class="mo" id="MathJax-Span-29024" style="font-size: 70.7%; font-family: STIXGeneral;">/</span></span></span><span class="mn" id="MathJax-Span-29025" style="font-size: 70.7%; font-family: STIXGeneral;">2</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 84.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span></span></span><span class="mi" id="MathJax-Span-29026" style="font-family: STIXGeneral; font-style: italic; padding-left: 3.3px;">e</span><span class="mi" id="MathJax-Span-29027" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span class="mi" id="MathJax-Span-29028" style="font-family: STIXGeneral; font-style: italic;">p</span><span class="mo" id="MathJax-Span-29029" style="font-family: STIXGeneral;">(</span><span class="mo" id="MathJax-Span-29030" style="font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-29031" style="font-family: STIXGeneral;">1</span><span class="texatom" id="MathJax-Span-29032"><span class="mrow" id="MathJax-Span-29033"><span class="mo" id="MathJax-Span-29034" style="font-family: STIXGeneral;">/</span></span></span><span class="mn" id="MathJax-Span-29035" style="font-family: STIXGeneral;">2</span><span class="mo" id="MathJax-Span-29036" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-29037" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span class="mo" id="MathJax-Span-29038" style="font-family: STIXGeneral; padding-left: 4.3px;">−</span><span class="mi" id="MathJax-Span-29039" style="font-family: STIXGeneral; font-style: italic; padding-left: 4.3px;">μ</span><span class="msubsup" id="MathJax-Span-29040"><span style="display: inline-block; position: relative; width: 15.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 50.1px -8.5px); top: -44px; left: 0px;"><span class="mo" id="MathJax-Span-29041" style="font-family: STIXGeneral;">)</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49px; left: 6px;"><span class="mi" id="MathJax-Span-29042" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.9px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="msubsup" id="MathJax-Span-29043"><span style="display: inline-block; position: relative; width: 27.3px; height: 0px;"><span style="position: absolute; clip: rect(29.5px 17360px 47px -8.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-29044" style="font-family: STIXGeneral;">Σ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.8px; left: 11px;"><span class="texatom" id="MathJax-Span-29045"><span class="mrow" id="MathJax-Span-29046"><span class="mo" id="MathJax-Span-29047" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-29048" style="font-size: 70.7%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-29049" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-29050" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span class="mo" id="MathJax-Span-29051" style="font-family: STIXGeneral; padding-left: 4.3px;">−</span><span class="mi" id="MathJax-Span-29052" style="font-family: STIXGeneral; font-style: italic; padding-left: 4.3px;">μ</span><span class="mo" id="MathJax-Span-29053" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-29054" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 43.6px; vertical-align: -19.1px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-935">p(x;\mu,\Sigma) = \dfrac{1}{(2\pi)^{n/2} |\Sigma|^{1/2}} exp(-1/2(x-\mu)^T\Sigma^{-1}(x-\mu))</script></p><p>The important effect is that we can model oblong gaussian contours, allowing us to better fit data that might not fit into the normal circular contours.</p><p>Varying Σ changes the shape, width, and orientation of the contours. Changing μ will move the center of the distribution.</p><p>Check also:</p><ul><li><a href="http://cs229.stanford.edu/section/gaussians.pdf" target="_blank" rel="noopener nofollow">The Multivariate Gaussian Distribution</a> <a href="http://cs229.stanford.edu/section/gaussians.pdf" target="_blank" rel="noopener nofollow">http://cs229.stanford.edu/section/gaussians.pdf</a> Chuong B. Do, October 10, 2008. </li></ul><h1>Anomaly Detection using the Multivariate Gaussian Distribution (Optional)</h1><p>When doing anomaly detection with multivariate gaussian distribution, we compute μ and Σ normally. We then compute p(x) using the new formula in the previous section and flag an anomaly if p(x) &lt; ϵ.</p><p>The original model for p(x) corresponds to a multivariate Gaussian where the contours of <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-936-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29055"><span style="display: inline-block; position: relative; width: 63px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(29.3px 17360px 50.6px -10.3px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-29056"><span class="mi" id="MathJax-Span-29057" style="font-family: STIXGeneral; font-style: italic;">p</span><span class="mo" id="MathJax-Span-29058" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-29059" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span class="mo" id="MathJax-Span-29060" style="font-family: STIXGeneral;">;</span><span class="mi" id="MathJax-Span-29061" style="font-family: STIXGeneral; font-style: italic; padding-left: 3.3px;">μ</span><span class="mo" id="MathJax-Span-29062" style="font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-29063" style="font-family: STIXGeneral; padding-left: 3.3px;">Σ</span><span class="mo" id="MathJax-Span-29064" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 17.3px; vertical-align: -4.6px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-936">p(x;\mu,\Sigma)</script> are axis-aligned.</p><p>The multivariate Gaussian model can automatically capture correlations between different features of x.</p><p>However, the original model maintains some advantages: it is computationally cheaper (no matrix to invert, which is costly for large number of features) and it performs well even with small training set size (in multivariate Gaussian model, it should be greater than the number of features for Σ to be invertible).</p><h1>ML:Recommender Systems</h1><h1>Problem Formulation</h1><p>Recommendation is currently a very popular application of machine learning.</p><p>Say we are trying to recommend movies to customers. We can use the following definitions</p><ul><li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-937-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29065"><span style="display: inline-block; position: relative; width: 33px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(33.3px 17360px 49.7px -8.8px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-29066"><span class="msubsup" id="MathJax-Span-29067"><span style="display: inline-block; position: relative; width: 16.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.8px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-29068" style="font-family: STIXGeneral; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -39.4px; left: 9px;"><span class="mi" id="MathJax-Span-29069" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">u</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-29070" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 12.4px; vertical-align: -3.7px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-937">n_u =</script> number of users</li><li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-938-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29071"><span style="display: inline-block; position: relative; width: 36px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(33.3px 17360px 49.7px -8.8px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-29072"><span class="msubsup" id="MathJax-Span-29073"><span style="display: inline-block; position: relative; width: 19.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.8px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-29074" style="font-family: STIXGeneral; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -39.4px; left: 9px;"><span class="mi" id="MathJax-Span-29075" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-29076" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 12.4px; vertical-align: -3.7px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-938">n_m =</script> number of movies</li><li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-939-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29077"><span style="display: inline-block; position: relative; width: 66px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(29.3px 17360px 50.6px -8.2px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-29078"><span class="mi" id="MathJax-Span-29079" style="font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.4px;"></span></span><span class="mo" id="MathJax-Span-29080" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-29081" style="font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-29082" style="font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-29083" style="font-family: STIXGeneral; font-style: italic; padding-left: 3.3px;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-29084" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-29085" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="mn" id="MathJax-Span-29086" style="font-family: STIXGeneral; padding-left: 5.4px;">1</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 17.3px; vertical-align: -4.6px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-939">r(i,j) = 1</script> if user j has rated movie i</li><li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-940-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29087"><span style="display: inline-block; position: relative; width: 53px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(29.3px 17360px 50.6px -9.4px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-29088"><span class="mi" id="MathJax-Span-29089" style="font-family: STIXGeneral; font-style: italic;">y</span><span class="mo" id="MathJax-Span-29090" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-29091" style="font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-29092" style="font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-29093" style="font-family: STIXGeneral; font-style: italic; padding-left: 3.3px;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-29094" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-29095" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 17.3px; vertical-align: -4.6px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-940">y(i,j) =</script> rating given by user j to movie i (defined only if r(i,j)=1)</li></ul><h1>Content Based Recommendations</h1><p>We can introduce two features, <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-941-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29096"><span style="display: inline-block; position: relative; width: 15px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(30.3px 17360px 46.6px -9.5px); top: -41px; left: 0px;"><span class="mrow" id="MathJax-Span-29097"><span class="msubsup" id="MathJax-Span-29098"><span style="display: inline-block; position: relative; width: 15.2px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -9.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-29099" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -39.4px; left: 7.9px;"><span class="mn" id="MathJax-Span-29100" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 12.3px; vertical-align: -3.6px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-941">x_1</script> and <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-942-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29101"><span style="display: inline-block; position: relative; width: 15px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(30.3px 17360px 46.6px -9.5px); top: -41px; left: 0px;"><span class="mrow" id="MathJax-Span-29102"><span class="msubsup" id="MathJax-Span-29103"><span style="display: inline-block; position: relative; width: 15.2px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -9.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-29104" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -39.4px; left: 7.9px;"><span class="mn" id="MathJax-Span-29105" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 12.3px; vertical-align: -3.6px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-942">x_2</script> which represents how much romance or how much action a movie may have (on a scale of 0−1).</p><p>One approach is that we could do linear regression for every single user. For each user j, learn a parameter <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-943-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29106"><span style="display: inline-block; position: relative; width: 65px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(25.7px 17360px 47.5px -8.5px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-29107"><span class="msubsup" id="MathJax-Span-29108"><span style="display: inline-block; position: relative; width: 23.2px; height: 0px;"><span style="position: absolute; clip: rect(29.2px 17360px 47.2px -8.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-29109" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49px; left: 9.9px;"><span class="texatom" id="MathJax-Span-29110"><span class="mrow" id="MathJax-Span-29111"><span class="mo" id="MathJax-Span-29112" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-29113" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-29114" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-29115" style="font-family: STIXGeneral; padding-left: 5.4px;">∈</span><span class="msubsup" id="MathJax-Span-29116" style="padding-left: 5.4px;"><span style="display: inline-block; position: relative; width: 20.3px; height: 0px;"><span style="position: absolute; clip: rect(29.5px 17360px 47px -7.8px); top: -44px; left: 0px;"><span class="texatom" id="MathJax-Span-29117"><span class="mrow" id="MathJax-Span-29118"><span class="mi" id="MathJax-Span-29119" style="font-family: STIXGeneral;">ℝ</span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.8px; left: 13px;"><span class="mn" id="MathJax-Span-29120" style="font-size: 70.7%; font-family: STIXGeneral;">3</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 17.8px; vertical-align: -1.5px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-943">\theta^{(j)} \in \mathbb{R}^3</script>. Predict user j as rating movie i with <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-944-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29121"><span style="display: inline-block; position: relative; width: 66px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(25.7px 17360px 50.1px -8.2px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-29122"><span class="mo" id="MathJax-Span-29123" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-29124"><span style="display: inline-block; position: relative; width: 23.2px; height: 0px;"><span style="position: absolute; clip: rect(29.2px 17360px 47.2px -8.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-29125" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49px; left: 9.9px;"><span class="texatom" id="MathJax-Span-29126"><span class="mrow" id="MathJax-Span-29127"><span class="mo" id="MathJax-Span-29128" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-29129" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-29130" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="msubsup" id="MathJax-Span-29131"><span style="display: inline-block; position: relative; width: 15.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 50.1px -8.5px); top: -44px; left: 0px;"><span class="mo" id="MathJax-Span-29132" style="font-family: STIXGeneral;">)</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49px; left: 6px;"><span class="mi" id="MathJax-Span-29133" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.9px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="msubsup" id="MathJax-Span-29134"><span style="display: inline-block; position: relative; width: 22.2px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -9.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-29135" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 8.9px;"><span class="texatom" id="MathJax-Span-29136"><span class="mrow" id="MathJax-Span-29137"><span class="mo" id="MathJax-Span-29138" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-29139" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-29140" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 20.4px; vertical-align: -4.1px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-944">(\theta^{(j)})^Tx^{(i)}</script> stars.</p><ul><li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-945-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29141"><span style="display: inline-block; position: relative; width: 40px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(25.7px 17360px 47.2px -8.5px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-29142"><span class="msubsup" id="MathJax-Span-29143"><span style="display: inline-block; position: relative; width: 23.2px; height: 0px;"><span style="position: absolute; clip: rect(29.2px 17360px 47.2px -8.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-29144" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49px; left: 9.9px;"><span class="texatom" id="MathJax-Span-29145"><span class="mrow" id="MathJax-Span-29146"><span class="mo" id="MathJax-Span-29147" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-29148" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-29149" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-29150" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 17.5px; vertical-align: -1.2px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-945">\theta^{(j)} =</script> parameter vector for user j</li><li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-946-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29151"><span style="display: inline-block; position: relative; width: 39px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(26.4px 17360px 47.2px -9.5px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-29152"><span class="msubsup" id="MathJax-Span-29153"><span style="display: inline-block; position: relative; width: 22.2px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -9.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-29154" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 8.9px;"><span class="texatom" id="MathJax-Span-29155"><span class="mrow" id="MathJax-Span-29156"><span class="mo" id="MathJax-Span-29157" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-29158" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-29159" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-29160" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 16.8px; vertical-align: -1.2px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-946">x^{(i)} =</script> feature vector for movie i</li></ul><p>For user j, movie i, predicted rating: <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-947-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29161"><span style="display: inline-block; position: relative; width: 78px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(25.7px 17360px 50.1px -8.2px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-29162"><span class="mo" id="MathJax-Span-29163" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-29164"><span style="display: inline-block; position: relative; width: 23.2px; height: 0px;"><span style="position: absolute; clip: rect(29.2px 17360px 47.2px -8.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-29165" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49px; left: 9.9px;"><span class="texatom" id="MathJax-Span-29166"><span class="mrow" id="MathJax-Span-29167"><span class="mo" id="MathJax-Span-29168" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-29169" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-29170" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="msubsup" id="MathJax-Span-29171"><span style="display: inline-block; position: relative; width: 15.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 50.1px -8.5px); top: -44px; left: 0px;"><span class="mo" id="MathJax-Span-29172" style="font-family: STIXGeneral;">)</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49px; left: 6px;"><span class="mi" id="MathJax-Span-29173" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.9px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-29174" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-29175"><span style="display: inline-block; position: relative; width: 22.2px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -9.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-29176" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 8.9px;"><span class="texatom" id="MathJax-Span-29177"><span class="mrow" id="MathJax-Span-29178"><span class="mo" id="MathJax-Span-29179" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-29180" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-29181" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-29182" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 20.4px; vertical-align: -4.1px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-947">(\theta^{(j)})^T(x^{(i)})</script></p><ul><li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-948-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29183"><span style="display: inline-block; position: relative; width: 43px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(26.4px 17360px 47.2px -8.8px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-29184"><span class="msubsup" id="MathJax-Span-29185"><span style="display: inline-block; position: relative; width: 26.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.8px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-29186" style="font-family: STIXGeneral; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 13px;"><span class="texatom" id="MathJax-Span-29187"><span class="mrow" id="MathJax-Span-29188"><span class="mo" id="MathJax-Span-29189" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-29190" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-29191" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-29192" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 16.8px; vertical-align: -1.2px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-948">m^{(j)} =</script> number of movies rated by user j</li></ul><p>To learn <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-949-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29193"><span style="display: inline-block; position: relative; width: 23px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(22.7px 17360px 44.2px -8.5px); top: -41px; left: 0px;"><span class="mrow" id="MathJax-Span-29194"><span class="msubsup" id="MathJax-Span-29195"><span style="display: inline-block; position: relative; width: 23.2px; height: 0px;"><span style="position: absolute; clip: rect(29.2px 17360px 47.2px -8.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-29196" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49px; left: 9.9px;"><span class="texatom" id="MathJax-Span-29197"><span class="mrow" id="MathJax-Span-29198"><span class="mo" id="MathJax-Span-29199" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-29200" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-29201" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 17.5px; vertical-align: -1.2px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-949">\theta^{(j)}</script>, we do the following</p><p><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-950-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29202"><span style="display: inline-block; position: relative; width: 374px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(13px 17360px 71.2px -8.8px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-29203"><span class="mi" id="MathJax-Span-29204" style="font-family: STIXGeneral; font-style: italic;">m</span><span class="mi" id="MathJax-Span-29205" style="font-family: STIXGeneral; font-style: italic;">i</span><span class="msubsup" id="MathJax-Span-29206"><span style="display: inline-block; position: relative; width: 26.1px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.8px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-29207" style="font-family: STIXGeneral; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -64.1px; left: 9px;"><span class="texatom" id="MathJax-Span-29208"><span class="mrow" id="MathJax-Span-29209"><span class="msubsup" id="MathJax-Span-29210"><span style="display: inline-block; position: relative; width: 15.8px; height: 0px;"><span style="position: absolute; clip: rect(30.7px 17360px 45.1px -8.7px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-29211" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -46px; left: 6.9px;"><span class="texatom" id="MathJax-Span-29212"><span class="mrow" id="MathJax-Span-29213"><span class="mo" id="MathJax-Span-29214" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-29215" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-29216" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 69px;"></span></span></span></span><span class="mo" id="MathJax-Span-29217" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="mstyle" id="MathJax-Span-29218" style="padding-left: 5.4px;"><span class="mrow" id="MathJax-Span-29219"><span class="mfrac" id="MathJax-Span-29220" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 11.1px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 47px -7.1px); top: -55.7px; left: 50%; margin-left: -4.5px;"><span class="mn" id="MathJax-Span-29221" style="font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(29.3px 17360px 47px -8.5px); top: -32.1px; left: 50%; margin-left: -4.5px;"><span class="mn" id="MathJax-Span-29222" style="font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 11.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span></span></span><span class="mstyle" id="MathJax-Span-29223" style="padding-left: 3.3px;"><span class="mrow" id="MathJax-Span-29224"><span class="munderover" id="MathJax-Span-29225"><span style="display: inline-block; position: relative; width: 44px; height: 0px;"><span style="position: absolute; clip: rect(31.1px 17360px 62.2px -7.4px); top: -51px; left: 11px;"><span class="mo" id="MathJax-Span-29226" style="font-family: STIXSizeOneSym; vertical-align: -9.1px;">∑</span><span style="display: inline-block; width: 0px; height: 51px;"></span></span><span style="position: absolute; clip: rect(30.7px 17360px 49.3px -8.4px); top: -22px; left: 0px;"><span class="texatom" id="MathJax-Span-29227"><span class="mrow" id="MathJax-Span-29228"><span class="mi" id="MathJax-Span-29229" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-29230" style="font-size: 70.7%; font-family: STIXGeneral;">:</span><span class="mi" id="MathJax-Span-29231" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.3px;"></span></span><span class="mo" id="MathJax-Span-29232" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-29233" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-29234" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-29235" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-29236" style="font-size: 70.7%; font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-29237" style="font-size: 70.7%; font-family: STIXGeneral;">=</span><span class="mn" id="MathJax-Span-29238" style="font-size: 70.7%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-29239" style="font-family: STIXGeneral;">(</span><span class="mo" id="MathJax-Span-29240" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-29241"><span style="display: inline-block; position: relative; width: 23.2px; height: 0px;"><span style="position: absolute; clip: rect(29.2px 17360px 47.2px -8.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-29242" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49.2px; left: 9.9px;"><span class="texatom" id="MathJax-Span-29243"><span class="mrow" id="MathJax-Span-29244"><span class="mo" id="MathJax-Span-29245" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-29246" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-29247" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="msubsup" id="MathJax-Span-29248"><span style="display: inline-block; position: relative; width: 15.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 50.1px -8.5px); top: -44px; left: 0px;"><span class="mo" id="MathJax-Span-29249" style="font-family: STIXGeneral;">)</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49.2px; left: 6px;"><span class="mi" id="MathJax-Span-29250" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.9px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-29251" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-29252"><span style="display: inline-block; position: relative; width: 22.2px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -9.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-29253" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49.2px; left: 8.9px;"><span class="texatom" id="MathJax-Span-29254"><span class="mrow" id="MathJax-Span-29255"><span class="mo" id="MathJax-Span-29256" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-29257" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-29258" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-29259" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-29260" style="font-family: STIXGeneral; padding-left: 4.3px;">−</span><span class="msubsup" id="MathJax-Span-29261" style="padding-left: 4.3px;"><span style="display: inline-block; position: relative; width: 27.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 50.6px -9.4px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-29262" style="font-family: STIXGeneral; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49.2px; left: 8px;"><span class="texatom" id="MathJax-Span-29263"><span class="mrow" id="MathJax-Span-29264"><span class="mo" id="MathJax-Span-29265" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-29266" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-29267" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-29268" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-29269" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="msubsup" id="MathJax-Span-29270"><span style="display: inline-block; position: relative; width: 13.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 50.1px -8.5px); top: -44px; left: 0px;"><span class="mo" id="MathJax-Span-29271" style="font-family: STIXGeneral;">)</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49.2px; left: 6px;"><span class="mn" id="MathJax-Span-29272" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-29273" style="font-family: STIXGeneral; padding-left: 4.3px;">+</span><span class="mstyle" id="MathJax-Span-29274" style="padding-left: 4.3px;"><span class="mrow" id="MathJax-Span-29275"><span class="mfrac" id="MathJax-Span-29276" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 11.1px; height: 0px;"><span style="position: absolute; clip: rect(29.2px 17360px 47.3px -9.2px); top: -55.7px; left: 50%; margin-left: -4px;"><span class="mi" id="MathJax-Span-29277" style="font-family: STIXGeneral; font-style: italic;">λ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(29.3px 17360px 47px -8.5px); top: -32.1px; left: 50%; margin-left: -4.5px;"><span class="mn" id="MathJax-Span-29278" style="font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 11.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span></span></span><span class="munderover" id="MathJax-Span-29279" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 22px; height: 0px;"><span style="position: absolute; clip: rect(31.1px 17360px 62.2px -7.4px); top: -51px; left: 0px;"><span class="mo" id="MathJax-Span-29280" style="font-family: STIXSizeOneSym; vertical-align: -9.1px;">∑</span><span style="display: inline-block; width: 0px; height: 51px;"></span></span><span style="position: absolute; clip: rect(30.6px 17360px 46.9px -8.8px); top: -22px; left: 1px;"><span class="texatom" id="MathJax-Span-29281"><span class="mrow" id="MathJax-Span-29282"><span class="mi" id="MathJax-Span-29283" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span class="mo" id="MathJax-Span-29284" style="font-size: 70.7%; font-family: STIXGeneral;">=</span><span class="mn" id="MathJax-Span-29285" style="font-size: 70.7%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(31.9px 17360px 45.1px -8.8px); top: -62.8px; left: 8px;"><span class="mi" id="MathJax-Span-29286" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-29287" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-29288"><span style="display: inline-block; position: relative; width: 23.2px; height: 0px;"><span style="position: absolute; clip: rect(29.2px 17360px 47.2px -8.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-29289" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(30.7px 17360px 47.5px -8.4px); top: -50.5px; left: 9.9px;"><span class="texatom" id="MathJax-Span-29290"><span class="mrow" id="MathJax-Span-29291"><span class="mo" id="MathJax-Span-29292" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-29293" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-29294" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(30.6px 17360px 45.1px -8.8px); top: -36.5px; left: 8.8px;"><span class="mi" id="MathJax-Span-29295" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="msubsup" id="MathJax-Span-29296"><span style="display: inline-block; position: relative; width: 13.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 50.1px -8.5px); top: -44px; left: 0px;"><span class="mo" id="MathJax-Span-29297" style="font-family: STIXGeneral;">)</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49.2px; left: 6px;"><span class="mn" id="MathJax-Span-29298" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 54.2px; vertical-align: -25.2px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-950">min_{\theta^{(j)}} = \dfrac{1}{2}\displaystyle \sum_{i:r(i,j)=1} ((\theta^{(j)})^T(x^{(i)}) - y^{(i,j)})^2 + \dfrac{\lambda}{2} \sum_{k=1}^n(\theta_k^{(j)})^2</script></p><p>This is our familiar linear regression. The base of the first summation is choosing all i such that <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-951-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29299"><span style="display: inline-block; position: relative; width: 66px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(29.3px 17360px 50.6px -8.2px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-29300"><span class="mi" id="MathJax-Span-29301" style="font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.4px;"></span></span><span class="mo" id="MathJax-Span-29302" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-29303" style="font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-29304" style="font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-29305" style="font-family: STIXGeneral; font-style: italic; padding-left: 3.3px;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-29306" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-29307" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="mn" id="MathJax-Span-29308" style="font-family: STIXGeneral; padding-left: 5.4px;">1</span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 17.3px; vertical-align: -4.6px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-951">r(i,j) = 1</script>.</p><p>To get the parameters for all our users, we do the following:</p><p><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-952-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29309"><span style="display: inline-block; position: relative; width: 466px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(12.8px 17360px 71.2px -8.8px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-29310"><span class="mi" id="MathJax-Span-29311" style="font-family: STIXGeneral; font-style: italic;">m</span><span class="mi" id="MathJax-Span-29312" style="font-family: STIXGeneral; font-style: italic;">i</span><span class="msubsup" id="MathJax-Span-29313"><span style="display: inline-block; position: relative; width: 68.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.8px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-29314" style="font-family: STIXGeneral; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -37.1px; left: 9px;"><span class="texatom" id="MathJax-Span-29315"><span class="mrow" id="MathJax-Span-29316"><span class="msubsup" id="MathJax-Span-29317"><span style="display: inline-block; position: relative; width: 17.8px; height: 0px;"><span style="position: absolute; clip: rect(30.7px 17360px 45.1px -8.7px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-29318" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -46px; left: 6.9px;"><span class="texatom" id="MathJax-Span-29319"><span class="mrow" id="MathJax-Span-29320"><span class="mo" id="MathJax-Span-29321" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-29322" style="font-size: 50%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-29323" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span><span class="mo" id="MathJax-Span-29324" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mo" id="MathJax-Span-29325" style="font-size: 70.7%; font-family: STIXGeneral;">…</span><span class="mo" id="MathJax-Span-29326" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-29327"><span style="display: inline-block; position: relative; width: 21.8px; height: 0px;"><span style="position: absolute; clip: rect(30.7px 17360px 45.1px -8.7px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-29328" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -46px; left: 6.9px;"><span class="texatom" id="MathJax-Span-29329"><span class="mrow" id="MathJax-Span-29330"><span class="mo" id="MathJax-Span-29331" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-29332"><span style="display: inline-block; position: relative; width: 8.7px; height: 0px;"><span style="position: absolute; clip: rect(34.2px 17360px 44.1px -8.9px); top: -41px; left: 0px;"><span class="mi" id="MathJax-Span-29333" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 41px;"></span></span><span style="position: absolute; top: -39.7px; left: 4px;"><span class="mi" id="MathJax-Span-29334" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">u</span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span><span class="mo" id="MathJax-Span-29335" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-29336" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="mstyle" id="MathJax-Span-29337" style="padding-left: 5.4px;"><span class="mrow" id="MathJax-Span-29338"><span class="mfrac" id="MathJax-Span-29339" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 11.1px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 47px -7.1px); top: -55.7px; left: 50%; margin-left: -4.5px;"><span class="mn" id="MathJax-Span-29340" style="font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(29.3px 17360px 47px -8.5px); top: -32.1px; left: 50%; margin-left: -4.5px;"><span class="mn" id="MathJax-Span-29341" style="font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 11.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span></span></span><span class="mstyle" id="MathJax-Span-29342" style="padding-left: 3.3px;"><span class="mrow" id="MathJax-Span-29343"><span class="munderover" id="MathJax-Span-29344"><span style="display: inline-block; position: relative; width: 22px; height: 0px;"><span style="position: absolute; clip: rect(31.1px 17360px 62.2px -7.4px); top: -51px; left: 0px;"><span class="mo" id="MathJax-Span-29345" style="font-family: STIXSizeOneSym; vertical-align: -9.1px;">∑</span><span style="display: inline-block; width: 0px; height: 51px;"></span></span><span style="position: absolute; clip: rect(30.7px 17360px 49.3px -10.5px); top: -22px; left: 2px;"><span class="texatom" id="MathJax-Span-29346"><span class="mrow" id="MathJax-Span-29347"><span class="mi" id="MathJax-Span-29348" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-29349" style="font-size: 70.7%; font-family: STIXGeneral;">=</span><span class="mn" id="MathJax-Span-29350" style="font-size: 70.7%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(58.9px 17360px 73.9px -8.8px); top: -90px; left: 5.5px;"><span class="texatom" id="MathJax-Span-29351"><span class="mrow" id="MathJax-Span-29352"><span class="msubsup" id="MathJax-Span-29353"><span style="display: inline-block; position: relative; width: 10.9px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 45.1px -8.8px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-29354" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -39.2px; left: 6px;"><span class="mi" id="MathJax-Span-29355" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">u</span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 69px;"></span></span></span></span><span class="munderover" id="MathJax-Span-29356" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 44px; height: 0px;"><span style="position: absolute; clip: rect(31.1px 17360px 62.2px -7.4px); top: -51px; left: 11px;"><span class="mo" id="MathJax-Span-29357" style="font-family: STIXSizeOneSym; vertical-align: -9.1px;">∑</span><span style="display: inline-block; width: 0px; height: 51px;"></span></span><span style="position: absolute; clip: rect(30.7px 17360px 49.3px -8.4px); top: -22px; left: 0px;"><span class="texatom" id="MathJax-Span-29358"><span class="mrow" id="MathJax-Span-29359"><span class="mi" id="MathJax-Span-29360" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-29361" style="font-size: 70.7%; font-family: STIXGeneral;">:</span><span class="mi" id="MathJax-Span-29362" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.3px;"></span></span><span class="mo" id="MathJax-Span-29363" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-29364" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-29365" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-29366" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-29367" style="font-size: 70.7%; font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-29368" style="font-size: 70.7%; font-family: STIXGeneral;">=</span><span class="mn" id="MathJax-Span-29369" style="font-size: 70.7%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-29370" style="font-family: STIXGeneral;">(</span><span class="mo" id="MathJax-Span-29371" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-29372"><span style="display: inline-block; position: relative; width: 23.2px; height: 0px;"><span style="position: absolute; clip: rect(29.2px 17360px 47.2px -8.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-29373" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49.2px; left: 9.9px;"><span class="texatom" id="MathJax-Span-29374"><span class="mrow" id="MathJax-Span-29375"><span class="mo" id="MathJax-Span-29376" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-29377" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-29378" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="msubsup" id="MathJax-Span-29379"><span style="display: inline-block; position: relative; width: 15.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 50.1px -8.5px); top: -44px; left: 0px;"><span class="mo" id="MathJax-Span-29380" style="font-family: STIXGeneral;">)</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49.2px; left: 6px;"><span class="mi" id="MathJax-Span-29381" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.9px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-29382" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-29383"><span style="display: inline-block; position: relative; width: 22.2px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -9.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-29384" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49.2px; left: 8.9px;"><span class="texatom" id="MathJax-Span-29385"><span class="mrow" id="MathJax-Span-29386"><span class="mo" id="MathJax-Span-29387" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-29388" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-29389" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-29390" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-29391" style="font-family: STIXGeneral; padding-left: 4.3px;">−</span><span class="msubsup" id="MathJax-Span-29392" style="padding-left: 4.3px;"><span style="display: inline-block; position: relative; width: 27.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 50.6px -9.4px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-29393" style="font-family: STIXGeneral; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49.2px; left: 8px;"><span class="texatom" id="MathJax-Span-29394"><span class="mrow" id="MathJax-Span-29395"><span class="mo" id="MathJax-Span-29396" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-29397" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-29398" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-29399" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-29400" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="msubsup" id="MathJax-Span-29401"><span style="display: inline-block; position: relative; width: 13.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 50.1px -8.5px); top: -44px; left: 0px;"><span class="mo" id="MathJax-Span-29402" style="font-family: STIXGeneral;">)</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49.2px; left: 6px;"><span class="mn" id="MathJax-Span-29403" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-29404" style="font-family: STIXGeneral; padding-left: 4.3px;">+</span><span class="mstyle" id="MathJax-Span-29405" style="padding-left: 4.3px;"><span class="mrow" id="MathJax-Span-29406"><span class="mfrac" id="MathJax-Span-29407" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 11.1px; height: 0px;"><span style="position: absolute; clip: rect(29.2px 17360px 47.3px -9.2px); top: -55.7px; left: 50%; margin-left: -4px;"><span class="mi" id="MathJax-Span-29408" style="font-family: STIXGeneral; font-style: italic;">λ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(29.3px 17360px 47px -8.5px); top: -32.1px; left: 50%; margin-left: -4.5px;"><span class="mn" id="MathJax-Span-29409" style="font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 11.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span></span></span><span class="munderover" id="MathJax-Span-29410" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 22px; height: 0px;"><span style="position: absolute; clip: rect(31.1px 17360px 62.2px -7.4px); top: -51px; left: 0px;"><span class="mo" id="MathJax-Span-29411" style="font-family: STIXSizeOneSym; vertical-align: -9.1px;">∑</span><span style="display: inline-block; width: 0px; height: 51px;"></span></span><span style="position: absolute; clip: rect(30.7px 17360px 49.3px -10.5px); top: -22px; left: 2px;"><span class="texatom" id="MathJax-Span-29412"><span class="mrow" id="MathJax-Span-29413"><span class="mi" id="MathJax-Span-29414" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-29415" style="font-size: 70.7%; font-family: STIXGeneral;">=</span><span class="mn" id="MathJax-Span-29416" style="font-size: 70.7%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(58.9px 17360px 73.9px -8.8px); top: -90px; left: 5.5px;"><span class="texatom" id="MathJax-Span-29417"><span class="mrow" id="MathJax-Span-29418"><span class="msubsup" id="MathJax-Span-29419"><span style="display: inline-block; position: relative; width: 10.9px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 45.1px -8.8px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-29420" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -39.2px; left: 6px;"><span class="mi" id="MathJax-Span-29421" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">u</span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 69px;"></span></span></span></span><span class="munderover" id="MathJax-Span-29422" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 22px; height: 0px;"><span style="position: absolute; clip: rect(31.1px 17360px 62.2px -7.4px); top: -51px; left: 0px;"><span class="mo" id="MathJax-Span-29423" style="font-family: STIXSizeOneSym; vertical-align: -9.1px;">∑</span><span style="display: inline-block; width: 0px; height: 51px;"></span></span><span style="position: absolute; clip: rect(30.6px 17360px 46.9px -8.8px); top: -22px; left: 1px;"><span class="texatom" id="MathJax-Span-29424"><span class="mrow" id="MathJax-Span-29425"><span class="mi" id="MathJax-Span-29426" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span class="mo" id="MathJax-Span-29427" style="font-size: 70.7%; font-family: STIXGeneral;">=</span><span class="mn" id="MathJax-Span-29428" style="font-size: 70.7%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(31.9px 17360px 45.1px -8.8px); top: -62.8px; left: 8px;"><span class="mi" id="MathJax-Span-29429" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-29430" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-29431"><span style="display: inline-block; position: relative; width: 23.2px; height: 0px;"><span style="position: absolute; clip: rect(29.2px 17360px 47.2px -8.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-29432" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(30.7px 17360px 47.5px -8.4px); top: -50.5px; left: 9.9px;"><span class="texatom" id="MathJax-Span-29433"><span class="mrow" id="MathJax-Span-29434"><span class="mo" id="MathJax-Span-29435" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-29436" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-29437" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(30.6px 17360px 45.1px -8.8px); top: -36.5px; left: 8.8px;"><span class="mi" id="MathJax-Span-29438" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="msubsup" id="MathJax-Span-29439"><span style="display: inline-block; position: relative; width: 13.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 50.1px -8.5px); top: -44px; left: 0px;"><span class="mo" id="MathJax-Span-29440" style="font-family: STIXGeneral;">)</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49.2px; left: 6px;"><span class="mn" id="MathJax-Span-29441" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 54.4px; vertical-align: -25.2px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-952">min_{\theta^{(1)},\dots,\theta^{(n_u)}} = \dfrac{1}{2}\displaystyle \sum_{j=1}^{n_u}  \sum_{i:r(i,j)=1} ((\theta^{(j)})^T(x^{(i)}) - y^{(i,j)})^2 + \dfrac{\lambda}{2} \sum_{j=1}^{n_u} \sum_{k=1}^n(\theta_k^{(j)})^2</script></p><p>We can apply our linear regression gradient descent update using the above cost function.</p><p>The only real difference is that we <strong>eliminate the constant </strong><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-953-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29442"><span style="display: inline-block; position: relative; width: 19px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(14.5px 17360px 56.1px -6.9px); top: -41px; left: 0px;"><span class="mrow" id="MathJax-Span-29443"><span class="mstyle" id="MathJax-Span-29444"><span class="mrow" id="MathJax-Span-29445"><span class="mfrac" id="MathJax-Span-29446" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 15.1px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 47px -7.1px); top: -55.7px; left: 50%; margin-left: -4.5px;"><span class="mn" id="MathJax-Span-29447" style="font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.8px); top: -32.1px; left: 50%; margin-left: -6.5px;"><span class="mi" id="MathJax-Span-29448" style="font-family: STIXGeneral; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 15.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 37.5px; vertical-align: -13.1px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-953">\dfrac{1}{m}</script>.</p><h1>Collaborative Filtering</h1><p>It can be very difficult to find features such as "amount of romance" or "amount of action" in a movie. To figure this out, we can use <em>feature finders</em>.</p><p>We can let the users tell us how much they like the different genres, providing their parameter vector immediately for us.</p><p>To infer the features from given parameters, we use the squared error function with regularization over all the users:</p><p><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-954-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29449"><span style="display: inline-block; position: relative; width: 435px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(12.8px 17360px 71.2px -8.8px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-29450"><span class="mi" id="MathJax-Span-29451" style="font-family: STIXGeneral; font-style: italic;">m</span><span class="mi" id="MathJax-Span-29452" style="font-family: STIXGeneral; font-style: italic;">i</span><span class="msubsup" id="MathJax-Span-29453"><span style="display: inline-block; position: relative; width: 68.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -8.8px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-29454" style="font-family: STIXGeneral; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -38.6px; left: 9px;"><span class="texatom" id="MathJax-Span-29455"><span class="mrow" id="MathJax-Span-29456"><span class="msubsup" id="MathJax-Span-29457"><span style="display: inline-block; position: relative; width: 16.8px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 45.1px -9.3px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-29458" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -44.5px; left: 5.9px;"><span class="texatom" id="MathJax-Span-29459"><span class="mrow" id="MathJax-Span-29460"><span class="mo" id="MathJax-Span-29461" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-29462" style="font-size: 50%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-29463" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span><span class="mo" id="MathJax-Span-29464" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mo" id="MathJax-Span-29465" style="font-size: 70.7%; font-family: STIXGeneral;">…</span><span class="mo" id="MathJax-Span-29466" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-29467"><span style="display: inline-block; position: relative; width: 22.8px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 45.1px -9.3px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-29468" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -44.5px; left: 5.9px;"><span class="texatom" id="MathJax-Span-29469"><span class="mrow" id="MathJax-Span-29470"><span class="mo" id="MathJax-Span-29471" style="font-size: 50%; font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-29472"><span style="display: inline-block; position: relative; width: 10.7px; height: 0px;"><span style="position: absolute; clip: rect(34.2px 17360px 44.1px -8.9px); top: -41px; left: 0px;"><span class="mi" id="MathJax-Span-29473" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 41px;"></span></span><span style="position: absolute; top: -39.7px; left: 4px;"><span class="mi" id="MathJax-Span-29474" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span><span class="mo" id="MathJax-Span-29475" style="font-size: 50%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mstyle" id="MathJax-Span-29476" style="padding-left: 3.3px;"><span class="mrow" id="MathJax-Span-29477"><span class="mfrac" id="MathJax-Span-29478" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 11.1px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 47px -7.1px); top: -55.7px; left: 50%; margin-left: -4.5px;"><span class="mn" id="MathJax-Span-29479" style="font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(29.3px 17360px 47px -8.5px); top: -32.1px; left: 50%; margin-left: -4.5px;"><span class="mn" id="MathJax-Span-29480" style="font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 11.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span></span></span><span class="mstyle" id="MathJax-Span-29481" style="padding-left: 3.3px;"><span class="mrow" id="MathJax-Span-29482"><span class="munderover" id="MathJax-Span-29483"><span style="display: inline-block; position: relative; width: 22px; height: 0px;"><span style="position: absolute; clip: rect(31.1px 17360px 62.2px -7.4px); top: -51px; left: 0px;"><span class="mo" id="MathJax-Span-29484" style="font-family: STIXSizeOneSym; vertical-align: -9.1px;">∑</span><span style="display: inline-block; width: 0px; height: 51px;"></span></span><span style="position: absolute; clip: rect(30.7px 17360px 46.9px -8.4px); top: -22px; left: 2px;"><span class="texatom" id="MathJax-Span-29485"><span class="mrow" id="MathJax-Span-29486"><span class="mi" id="MathJax-Span-29487" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-29488" style="font-size: 70.7%; font-family: STIXGeneral;">=</span><span class="mn" id="MathJax-Span-29489" style="font-size: 70.7%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(58.9px 17360px 73.9px -8.8px); top: -90px; left: 4.5px;"><span class="texatom" id="MathJax-Span-29490"><span class="mrow" id="MathJax-Span-29491"><span class="msubsup" id="MathJax-Span-29492"><span style="display: inline-block; position: relative; width: 12.9px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 45.1px -8.8px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-29493" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -39.2px; left: 6px;"><span class="mi" id="MathJax-Span-29494" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 69px;"></span></span></span></span><span class="munderover" id="MathJax-Span-29495" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 44px; height: 0px;"><span style="position: absolute; clip: rect(31.1px 17360px 62.2px -7.4px); top: -51px; left: 11px;"><span class="mo" id="MathJax-Span-29496" style="font-family: STIXSizeOneSym; vertical-align: -9.1px;">∑</span><span style="display: inline-block; width: 0px; height: 51px;"></span></span><span style="position: absolute; clip: rect(30.7px 17360px 49.3px -10.5px); top: -22px; left: 0px;"><span class="texatom" id="MathJax-Span-29497"><span class="mrow" id="MathJax-Span-29498"><span class="mi" id="MathJax-Span-29499" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-29500" style="font-size: 70.7%; font-family: STIXGeneral;">:</span><span class="mi" id="MathJax-Span-29501" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.3px;"></span></span><span class="mo" id="MathJax-Span-29502" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-29503" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-29504" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-29505" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-29506" style="font-size: 70.7%; font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-29507" style="font-size: 70.7%; font-family: STIXGeneral;">=</span><span class="mn" id="MathJax-Span-29508" style="font-size: 70.7%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-29509" style="font-family: STIXGeneral;">(</span><span class="mo" id="MathJax-Span-29510" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-29511"><span style="display: inline-block; position: relative; width: 23.2px; height: 0px;"><span style="position: absolute; clip: rect(29.2px 17360px 47.2px -8.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-29512" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49.2px; left: 9.9px;"><span class="texatom" id="MathJax-Span-29513"><span class="mrow" id="MathJax-Span-29514"><span class="mo" id="MathJax-Span-29515" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-29516" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-29517" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="msubsup" id="MathJax-Span-29518"><span style="display: inline-block; position: relative; width: 15.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 50.1px -8.5px); top: -44px; left: 0px;"><span class="mo" id="MathJax-Span-29519" style="font-family: STIXGeneral;">)</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49.2px; left: 6px;"><span class="mi" id="MathJax-Span-29520" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.9px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="msubsup" id="MathJax-Span-29521"><span style="display: inline-block; position: relative; width: 22.2px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -9.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-29522" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49.2px; left: 8.9px;"><span class="texatom" id="MathJax-Span-29523"><span class="mrow" id="MathJax-Span-29524"><span class="mo" id="MathJax-Span-29525" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-29526" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-29527" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-29528" style="font-family: STIXGeneral; padding-left: 4.3px;">−</span><span class="msubsup" id="MathJax-Span-29529" style="padding-left: 4.3px;"><span style="display: inline-block; position: relative; width: 27.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 50.6px -9.4px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-29530" style="font-family: STIXGeneral; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49.2px; left: 8px;"><span class="texatom" id="MathJax-Span-29531"><span class="mrow" id="MathJax-Span-29532"><span class="mo" id="MathJax-Span-29533" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-29534" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-29535" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-29536" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-29537" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="msubsup" id="MathJax-Span-29538"><span style="display: inline-block; position: relative; width: 13.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 50.1px -8.5px); top: -44px; left: 0px;"><span class="mo" id="MathJax-Span-29539" style="font-family: STIXGeneral;">)</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49.2px; left: 6px;"><span class="mn" id="MathJax-Span-29540" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-29541" style="font-family: STIXGeneral; padding-left: 4.3px;">+</span><span class="mstyle" id="MathJax-Span-29542" style="padding-left: 4.3px;"><span class="mrow" id="MathJax-Span-29543"><span class="mfrac" id="MathJax-Span-29544" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 11.1px; height: 0px;"><span style="position: absolute; clip: rect(29.2px 17360px 47.3px -9.2px); top: -55.7px; left: 50%; margin-left: -4px;"><span class="mi" id="MathJax-Span-29545" style="font-family: STIXGeneral; font-style: italic;">λ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(29.3px 17360px 47px -8.5px); top: -32.1px; left: 50%; margin-left: -4.5px;"><span class="mn" id="MathJax-Span-29546" style="font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 11.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span></span></span><span class="munderover" id="MathJax-Span-29547" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 22px; height: 0px;"><span style="position: absolute; clip: rect(31.1px 17360px 62.2px -7.4px); top: -51px; left: 0px;"><span class="mo" id="MathJax-Span-29548" style="font-family: STIXSizeOneSym; vertical-align: -9.1px;">∑</span><span style="display: inline-block; width: 0px; height: 51px;"></span></span><span style="position: absolute; clip: rect(30.7px 17360px 46.9px -8.4px); top: -22px; left: 2px;"><span class="texatom" id="MathJax-Span-29549"><span class="mrow" id="MathJax-Span-29550"><span class="mi" id="MathJax-Span-29551" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-29552" style="font-size: 70.7%; font-family: STIXGeneral;">=</span><span class="mn" id="MathJax-Span-29553" style="font-size: 70.7%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(58.9px 17360px 73.9px -8.8px); top: -90px; left: 4.5px;"><span class="texatom" id="MathJax-Span-29554"><span class="mrow" id="MathJax-Span-29555"><span class="msubsup" id="MathJax-Span-29556"><span style="display: inline-block; position: relative; width: 12.9px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 45.1px -8.8px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-29557" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -39.2px; left: 6px;"><span class="mi" id="MathJax-Span-29558" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 69px;"></span></span></span></span><span class="munderover" id="MathJax-Span-29559" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 22px; height: 0px;"><span style="position: absolute; clip: rect(31.1px 17360px 62.2px -7.4px); top: -51px; left: 0px;"><span class="mo" id="MathJax-Span-29560" style="font-family: STIXSizeOneSym; vertical-align: -9.1px;">∑</span><span style="display: inline-block; width: 0px; height: 51px;"></span></span><span style="position: absolute; clip: rect(30.6px 17360px 46.9px -8.8px); top: -22px; left: 1px;"><span class="texatom" id="MathJax-Span-29561"><span class="mrow" id="MathJax-Span-29562"><span class="mi" id="MathJax-Span-29563" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span class="mo" id="MathJax-Span-29564" style="font-size: 70.7%; font-family: STIXGeneral;">=</span><span class="mn" id="MathJax-Span-29565" style="font-size: 70.7%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(31.9px 17360px 45.1px -8.8px); top: -62.8px; left: 8px;"><span class="texatom" id="MathJax-Span-29566"><span class="mrow" id="MathJax-Span-29567"><span class="mi" id="MathJax-Span-29568" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-29569" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-29570"><span style="display: inline-block; position: relative; width: 22.2px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -9.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-29571" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(30.7px 17360px 47.2px -8.4px); top: -50.2px; left: 8.9px;"><span class="texatom" id="MathJax-Span-29572"><span class="mrow" id="MathJax-Span-29573"><span class="mo" id="MathJax-Span-29574" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-29575" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-29576" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(30.6px 17360px 45.1px -8.8px); top: -36.5px; left: 7.9px;"><span class="mi" id="MathJax-Span-29577" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="msubsup" id="MathJax-Span-29578"><span style="display: inline-block; position: relative; width: 13.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 50.1px -8.5px); top: -44px; left: 0px;"><span class="mo" id="MathJax-Span-29579" style="font-family: STIXGeneral;">)</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49.2px; left: 6px;"><span class="mn" id="MathJax-Span-29580" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 54.4px; vertical-align: -25.2px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-954">min_{x^{(1)},\dots,x^{(n_m)}} \dfrac{1}{2} \displaystyle \sum_{i=1}^{n_m}  \sum_{j:r(i,j)=1} ((\theta^{(j)})^T x^{(i)} - y^{(i,j)})^2 + \dfrac{\lambda}{2}\sum_{i=1}^{n_m} \sum_{k=1}^{n} (x_k^{(i)})^2</script></p><p>You can also <strong>randomly guess</strong> the values for theta to guess the features repeatedly. You will actually converge to a good set of features.</p><h1>Collaborative Filtering Algorithm</h1><p>To speed things up, we can simultaneously minimize our features and our parameters:</p><p><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-955-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29581"><span style="display: inline-block; position: relative; width: 529px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(12.8px 17360px 71.2px -9.1px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-29582"><span class="mi" id="MathJax-Span-29583" style="font-family: STIXGeneral; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.8px;"></span></span><span class="mo" id="MathJax-Span-29584" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-29585" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span class="mo" id="MathJax-Span-29586" style="font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-29587" style="font-family: STIXGeneral; font-style: italic; padding-left: 3.3px;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span class="mo" id="MathJax-Span-29588" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-29589" style="font-family: STIXGeneral; padding-left: 5.4px;">=</span><span class="mstyle" id="MathJax-Span-29590" style="padding-left: 5.4px;"><span class="mrow" id="MathJax-Span-29591"><span class="mfrac" id="MathJax-Span-29592" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 11.1px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 47px -7.1px); top: -55.7px; left: 50%; margin-left: -4.5px;"><span class="mn" id="MathJax-Span-29593" style="font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(29.3px 17360px 47px -8.5px); top: -32.1px; left: 50%; margin-left: -4.5px;"><span class="mn" id="MathJax-Span-29594" style="font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 11.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span></span></span><span class="mstyle" id="MathJax-Span-29595" style="padding-left: 3.3px;"><span class="mrow" id="MathJax-Span-29596"><span class="munderover" id="MathJax-Span-29597"><span style="display: inline-block; position: relative; width: 59px; height: 0px;"><span style="position: absolute; clip: rect(31.1px 17360px 62.2px -7.4px); top: -51px; left: 18.5px;"><span class="mo" id="MathJax-Span-29598" style="font-family: STIXSizeOneSym; vertical-align: -9.1px;">∑</span><span style="display: inline-block; width: 0px; height: 51px;"></span></span><span style="position: absolute; clip: rect(30.7px 17360px 49.3px -8.4px); top: -22px; left: 0px;"><span class="texatom" id="MathJax-Span-29599"><span class="mrow" id="MathJax-Span-29600"><span class="mo" id="MathJax-Span-29601" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-29602" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-29603" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-29604" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-29605" style="font-size: 70.7%; font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-29606" style="font-size: 70.7%; font-family: STIXGeneral;">:</span><span class="mi" id="MathJax-Span-29607" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.3px;"></span></span><span class="mo" id="MathJax-Span-29608" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-29609" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-29610" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-29611" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-29612" style="font-size: 70.7%; font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-29613" style="font-size: 70.7%; font-family: STIXGeneral;">=</span><span class="mn" id="MathJax-Span-29614" style="font-size: 70.7%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-29615" style="font-family: STIXGeneral;">(</span><span class="mo" id="MathJax-Span-29616" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-29617"><span style="display: inline-block; position: relative; width: 23.2px; height: 0px;"><span style="position: absolute; clip: rect(29.2px 17360px 47.2px -8.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-29618" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49.2px; left: 9.9px;"><span class="texatom" id="MathJax-Span-29619"><span class="mrow" id="MathJax-Span-29620"><span class="mo" id="MathJax-Span-29621" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-29622" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-29623" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="msubsup" id="MathJax-Span-29624"><span style="display: inline-block; position: relative; width: 15.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 50.1px -8.5px); top: -44px; left: 0px;"><span class="mo" id="MathJax-Span-29625" style="font-family: STIXGeneral;">)</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49.2px; left: 6px;"><span class="mi" id="MathJax-Span-29626" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.9px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="msubsup" id="MathJax-Span-29627"><span style="display: inline-block; position: relative; width: 22.2px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -9.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-29628" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49.2px; left: 8.9px;"><span class="texatom" id="MathJax-Span-29629"><span class="mrow" id="MathJax-Span-29630"><span class="mo" id="MathJax-Span-29631" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-29632" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-29633" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-29634" style="font-family: STIXGeneral; padding-left: 4.3px;">−</span><span class="msubsup" id="MathJax-Span-29635" style="padding-left: 4.3px;"><span style="display: inline-block; position: relative; width: 27.3px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 50.6px -9.4px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-29636" style="font-family: STIXGeneral; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49.2px; left: 8px;"><span class="texatom" id="MathJax-Span-29637"><span class="mrow" id="MathJax-Span-29638"><span class="mo" id="MathJax-Span-29639" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-29640" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-29641" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-29642" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-29643" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="msubsup" id="MathJax-Span-29644"><span style="display: inline-block; position: relative; width: 13.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 50.1px -8.5px); top: -44px; left: 0px;"><span class="mo" id="MathJax-Span-29645" style="font-family: STIXGeneral;">)</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49.2px; left: 6px;"><span class="mn" id="MathJax-Span-29646" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-29647" style="font-family: STIXGeneral; padding-left: 4.3px;">+</span><span class="mstyle" id="MathJax-Span-29648" style="padding-left: 4.3px;"><span class="mrow" id="MathJax-Span-29649"><span class="mfrac" id="MathJax-Span-29650" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 11.1px; height: 0px;"><span style="position: absolute; clip: rect(29.2px 17360px 47.3px -9.2px); top: -55.7px; left: 50%; margin-left: -4px;"><span class="mi" id="MathJax-Span-29651" style="font-family: STIXGeneral; font-style: italic;">λ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(29.3px 17360px 47px -8.5px); top: -32.1px; left: 50%; margin-left: -4.5px;"><span class="mn" id="MathJax-Span-29652" style="font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 11.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span></span></span><span class="munderover" id="MathJax-Span-29653" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 22px; height: 0px;"><span style="position: absolute; clip: rect(31.1px 17360px 62.2px -7.4px); top: -51px; left: 0px;"><span class="mo" id="MathJax-Span-29654" style="font-family: STIXSizeOneSym; vertical-align: -9.1px;">∑</span><span style="display: inline-block; width: 0px; height: 51px;"></span></span><span style="position: absolute; clip: rect(30.7px 17360px 46.9px -8.4px); top: -22px; left: 2px;"><span class="texatom" id="MathJax-Span-29655"><span class="mrow" id="MathJax-Span-29656"><span class="mi" id="MathJax-Span-29657" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-29658" style="font-size: 70.7%; font-family: STIXGeneral;">=</span><span class="mn" id="MathJax-Span-29659" style="font-size: 70.7%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(58.9px 17360px 73.9px -8.8px); top: -90px; left: 4.5px;"><span class="texatom" id="MathJax-Span-29660"><span class="mrow" id="MathJax-Span-29661"><span class="msubsup" id="MathJax-Span-29662"><span style="display: inline-block; position: relative; width: 12.9px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 45.1px -8.8px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-29663" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -39.2px; left: 6px;"><span class="mi" id="MathJax-Span-29664" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 69px;"></span></span></span></span><span class="munderover" id="MathJax-Span-29665" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 22px; height: 0px;"><span style="position: absolute; clip: rect(31.1px 17360px 62.2px -7.4px); top: -51px; left: 0px;"><span class="mo" id="MathJax-Span-29666" style="font-family: STIXSizeOneSym; vertical-align: -9.1px;">∑</span><span style="display: inline-block; width: 0px; height: 51px;"></span></span><span style="position: absolute; clip: rect(30.6px 17360px 46.9px -8.8px); top: -22px; left: 1px;"><span class="texatom" id="MathJax-Span-29667"><span class="mrow" id="MathJax-Span-29668"><span class="mi" id="MathJax-Span-29669" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span class="mo" id="MathJax-Span-29670" style="font-size: 70.7%; font-family: STIXGeneral;">=</span><span class="mn" id="MathJax-Span-29671" style="font-size: 70.7%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(31.9px 17360px 45.1px -8.8px); top: -62.8px; left: 8px;"><span class="texatom" id="MathJax-Span-29672"><span class="mrow" id="MathJax-Span-29673"><span class="mi" id="MathJax-Span-29674" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-29675" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-29676"><span style="display: inline-block; position: relative; width: 22.2px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -9.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-29677" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(30.7px 17360px 47.2px -8.4px); top: -50.2px; left: 8.9px;"><span class="texatom" id="MathJax-Span-29678"><span class="mrow" id="MathJax-Span-29679"><span class="mo" id="MathJax-Span-29680" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-29681" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-29682" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(30.6px 17360px 45.1px -8.8px); top: -36.5px; left: 7.9px;"><span class="mi" id="MathJax-Span-29683" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="msubsup" id="MathJax-Span-29684"><span style="display: inline-block; position: relative; width: 13.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 50.1px -8.5px); top: -44px; left: 0px;"><span class="mo" id="MathJax-Span-29685" style="font-family: STIXGeneral;">)</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49.2px; left: 6px;"><span class="mn" id="MathJax-Span-29686" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-29687" style="font-family: STIXGeneral; padding-left: 4.3px;">+</span><span class="mstyle" id="MathJax-Span-29688" style="padding-left: 4.3px;"><span class="mrow" id="MathJax-Span-29689"><span class="mfrac" id="MathJax-Span-29690" style="padding-left: 2.1px; padding-right: 2.1px;"><span style="display: inline-block; position: relative; width: 11.1px; height: 0px;"><span style="position: absolute; clip: rect(29.2px 17360px 47.3px -9.2px); top: -55.7px; left: 50%; margin-left: -4px;"><span class="mi" id="MathJax-Span-29691" style="font-family: STIXGeneral; font-style: italic;">λ</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(29.3px 17360px 47px -8.5px); top: -32.1px; left: 50%; margin-left: -4.5px;"><span class="mn" id="MathJax-Span-29692" style="font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(14.8px 17360px 22px -9px); top: -22.8px; left: 0px;"><span style="border-left: 11.1px solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0px;"></span><span style="display: inline-block; width: 0px; height: 19px;"></span></span></span></span></span></span><span class="munderover" id="MathJax-Span-29693" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 22px; height: 0px;"><span style="position: absolute; clip: rect(31.1px 17360px 62.2px -7.4px); top: -51px; left: 0px;"><span class="mo" id="MathJax-Span-29694" style="font-family: STIXSizeOneSym; vertical-align: -9.1px;">∑</span><span style="display: inline-block; width: 0px; height: 51px;"></span></span><span style="position: absolute; clip: rect(30.7px 17360px 49.3px -10.5px); top: -22px; left: 2px;"><span class="texatom" id="MathJax-Span-29695"><span class="mrow" id="MathJax-Span-29696"><span class="mi" id="MathJax-Span-29697" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-29698" style="font-size: 70.7%; font-family: STIXGeneral;">=</span><span class="mn" id="MathJax-Span-29699" style="font-size: 70.7%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(58.9px 17360px 73.9px -8.8px); top: -90px; left: 5.5px;"><span class="texatom" id="MathJax-Span-29700"><span class="mrow" id="MathJax-Span-29701"><span class="msubsup" id="MathJax-Span-29702"><span style="display: inline-block; position: relative; width: 10.9px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 45.1px -8.8px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-29703" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -39.2px; left: 6px;"><span class="mi" id="MathJax-Span-29704" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">u</span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 69px;"></span></span></span></span><span class="munderover" id="MathJax-Span-29705" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 22px; height: 0px;"><span style="position: absolute; clip: rect(31.1px 17360px 62.2px -7.4px); top: -51px; left: 0px;"><span class="mo" id="MathJax-Span-29706" style="font-family: STIXSizeOneSym; vertical-align: -9.1px;">∑</span><span style="display: inline-block; width: 0px; height: 51px;"></span></span><span style="position: absolute; clip: rect(30.6px 17360px 46.9px -8.8px); top: -22px; left: 1px;"><span class="texatom" id="MathJax-Span-29707"><span class="mrow" id="MathJax-Span-29708"><span class="mi" id="MathJax-Span-29709" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span class="mo" id="MathJax-Span-29710" style="font-size: 70.7%; font-family: STIXGeneral;">=</span><span class="mn" id="MathJax-Span-29711" style="font-size: 70.7%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(31.9px 17360px 45.1px -8.8px); top: -62.8px; left: 8px;"><span class="texatom" id="MathJax-Span-29712"><span class="mrow" id="MathJax-Span-29713"><span class="mi" id="MathJax-Span-29714" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-29715" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-29716"><span style="display: inline-block; position: relative; width: 23.2px; height: 0px;"><span style="position: absolute; clip: rect(29.2px 17360px 47.2px -8.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-29717" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; clip: rect(30.7px 17360px 47.5px -8.4px); top: -50.5px; left: 9.9px;"><span class="texatom" id="MathJax-Span-29718"><span class="mrow" id="MathJax-Span-29719"><span class="mo" id="MathJax-Span-29720" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-29721" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0px;"></span></span><span class="mo" id="MathJax-Span-29722" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; clip: rect(30.6px 17360px 45.1px -8.8px); top: -36.5px; left: 8.8px;"><span class="mi" id="MathJax-Span-29723" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="msubsup" id="MathJax-Span-29724"><span style="display: inline-block; position: relative; width: 13.3px; height: 0px;"><span style="position: absolute; clip: rect(29.3px 17360px 50.1px -8.5px); top: -44px; left: 0px;"><span class="mo" id="MathJax-Span-29725" style="font-family: STIXGeneral;">)</span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49.2px; left: 6px;"><span class="mn" id="MathJax-Span-29726" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 54.4px; vertical-align: -25.2px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-955">J(x,\theta) = \dfrac{1}{2} \displaystyle \sum_{(i,j):r(i,j)=1}((\theta^{(j)})^Tx^{(i)} - y^{(i,j)})^2 + \dfrac{\lambda}{2}\sum_{i=1}^{n_m} \sum_{k=1}^{n} (x_k^{(i)})^2 + \dfrac{\lambda}{2}\sum_{j=1}^{n_u} \sum_{k=1}^{n} (\theta_k^{(j)})^2</script></p><p>It looks very complicated, but we've only combined the cost function for theta and the cost function for x.</p><p>Because the algorithm can learn them itself, the bias units where x0=1 have been removed, therefore x∈ℝn and θ∈ℝn.</p><p>These are the steps in the algorithm:</p><ol><li>Initialize <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-956-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-29727"><span style="display: inline-block; position: relative; width: 189px; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(25.7px 17360px 49.4px -9.5px); top: -44px; left: 0px;"><span class="mrow" id="MathJax-Span-29728"><span class="msubsup" id="MathJax-Span-29729"><span style="display: inline-block; position: relative; width: 22.2px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -9.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-29730" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 8.9px;"><span class="texatom" id="MathJax-Span-29731"><span class="mrow" id="MathJax-Span-29732"><span class="mo" id="MathJax-Span-29733" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-29734" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-29735" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-29736" style="font-family: STIXGeneral;">,</span><span class="mo" id="MathJax-Span-29737" style="font-family: STIXGeneral; padding-left: 3.3px;">.</span><span class="mo" id="MathJax-Span-29738" style="font-family: STIXGeneral; padding-left: 3.3px;">.</span><span class="mo" id="MathJax-Span-29739" style="font-family: STIXGeneral; padding-left: 3.3px;">.</span><span class="mo" id="MathJax-Span-29740" style="font-family: STIXGeneral; padding-left: 3.3px;">,</span><span class="msubsup" id="MathJax-Span-29741" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 31.2px; height: 0px;"><span style="position: absolute; clip: rect(33.3px 17360px 47.2px -9.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-29742" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -48.3px; left: 8.9px;"><span class="texatom" id="MathJax-Span-29743"><span class="mrow" id="MathJax-Span-29744"><span class="mo" id="MathJax-Span-29745" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-29746"><span style="display: inline-block; position: relative; width: 12.9px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 45.1px -8.8px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-29747" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -39.2px; left: 6px;"><span class="mi" id="MathJax-Span-29748" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span><span class="mo" id="MathJax-Span-29749" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-29750" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-29751" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 25.2px; height: 0px;"><span style="position: absolute; clip: rect(29.2px 17360px 47.2px -8.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-29752" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49px; left: 9.9px;"><span class="texatom" id="MathJax-Span-29753"><span class="mrow" id="MathJax-Span-29754"><span class="mo" id="MathJax-Span-29755" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-29756" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-29757" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span><span class="mo" id="MathJax-Span-29758" style="font-family: STIXGeneral;">,</span><span class="mo" id="MathJax-Span-29759" style="font-family: STIXGeneral; padding-left: 3.3px;">.</span><span class="mo" id="MathJax-Span-29760" style="font-family: STIXGeneral; padding-left: 3.3px;">.</span><span class="mo" id="MathJax-Span-29761" style="font-family: STIXGeneral; padding-left: 3.3px;">.</span><span class="mo" id="MathJax-Span-29762" style="font-family: STIXGeneral; padding-left: 3.3px;">,</span><span class="msubsup" id="MathJax-Span-29763" style="padding-left: 3.3px;"><span style="display: inline-block; position: relative; width: 30.2px; height: 0px;"><span style="position: absolute; clip: rect(29.2px 17360px 47.2px -8.5px); top: -44px; left: 0px;"><span class="mi" id="MathJax-Span-29764" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.2px;"></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span><span style="position: absolute; top: -49px; left: 9.9px;"><span class="texatom" id="MathJax-Span-29765"><span class="mrow" id="MathJax-Span-29766"><span class="mo" id="MathJax-Span-29767" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-29768"><span style="display: inline-block; position: relative; width: 10.9px; height: 0px;"><span style="position: absolute; clip: rect(33.6px 17360px 45.1px -8.8px); top: -42px; left: 0px;"><span class="mi" id="MathJax-Span-29769" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 42px;"></span></span><span style="position: absolute; top: -39.2px; left: 6px;"><span class="mi" id="MathJax-Span-29770" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">u</span><span style="display: inline-block; width: 0px; height: 41px;"></span></span></span></span><span class="mo" id="MathJax-Span-29771" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 42px;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 44px;"></span></span></span><span style="border-left: 0px solid; display: inline-block; overflow: hidden; width: 0px; height: 19.8px; vertical-align: -3.4px;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-956">x^{(i)},...,x^{(n_m)},\theta^{(1)},...,\theta^{(n_u)}</script> to small random values. This serves to break symmetry and ensures that the algorithm learns features <span class="MathJax_Preview"></span><span class="MathJax MathJax_Processing" id="MathJax-Element-957-Frame" role="textbox" aria-readonly="true"></span><script type="math/tex" id="MathJax-Element-957">x^{(i)},...,x^{(n_m)}</script> that are different from each other.</li><li>Minimize <span class="MathJax_Preview"></span><span class="MathJax MathJax_Processing" id="MathJax-Element-958-Frame" role="textbox" aria-readonly="true"></span><script type="math/tex" id="MathJax-Element-958">J(x^{(i)},...,x^{(n_m)},\theta^{(1)},...,\theta^{(n_u)})</script> using gradient descent (or an advanced optimization algorithm).E.g. for every <span class="MathJax_Preview"></span><span class="MathJax MathJax_Processing" id="MathJax-Element-959-Frame" role="textbox" aria-readonly="true"></span><script type="math/tex" id="MathJax-Element-959">j=1,...,n_u,i=1,...n_m</script>:<span class="MathJax_Preview"></span><span class="MathJax MathJax_Processing" id="MathJax-Element-960-Frame" role="textbox" aria-readonly="true"></span><script type="math/tex" id="MathJax-Element-960">x_k^{(i)} := x_k^{(i)} - \alpha\left (\displaystyle \sum_{j:r(i,j)=1}{((\theta^{(j)})^T x^{(i)} - y^{(i,j)}) \theta_k^{(j)}} + \lambda x_k^{(i)} \right)</script><span class="MathJax_Preview"></span><span class="MathJax MathJax_Processing" id="MathJax-Element-961-Frame" role="textbox" aria-readonly="true"></span><script type="math/tex" id="MathJax-Element-961">\theta_k^{(j)} := \theta_k^{(j)} - \alpha\left (\displaystyle \sum_{i:r(i,j)=1}{((\theta^{(j)})^T x^{(i)} - y^{(i,j)}) x_k^{(i)}} + \lambda \theta_k^{(j)} \right)</script></li><li>For a user with parameters θ and a movie with (learned) features x, predict a star rating of <span class="MathJax_Preview"></span><span class="MathJax MathJax_Processing" id="MathJax-Element-962-Frame" role="textbox" aria-readonly="true"></span><script type="math/tex" id="MathJax-Element-962">\theta^Tx</script>.</li></ol><h1>Vectorization: Low Rank Matrix Factorization</h1><p>Given matrices X (each row containing features of a particular movie) and Θ (each row containing the weights for those features for a given user), then the full matrix Y of all predicted ratings of all movies by all users is given simply by: <span class="MathJax_Preview"></span><span class="MathJax MathJax_Processing" id="MathJax-Element-963-Frame" role="textbox" aria-readonly="true"></span><script type="math/tex" id="MathJax-Element-963">Y = X\Theta^T</script>.</p><p>Predicting how similar two movies i and j are can be done using the distance between their respective feature vectors x. Specifically, we are looking for a small value of <span class="MathJax_Preview"></span><span class="MathJax MathJax_Processing" id="MathJax-Element-964-Frame" role="textbox" aria-readonly="true"></span><script type="math/tex" id="MathJax-Element-964">||x^{(i)} - x^{(j)}||</script>.</p><h1>Implementation Detail: Mean Normalization</h1><p>If the ranking system for movies is used from the previous lectures, then new users (who have watched no movies), will be assigned new movies incorrectly. Specifically, they will be assigned θ with all components equal to zero due to the minimization of the regularization term. That is, we assume that the new user will rank all movies 0, which does not seem intuitively correct.</p><p>We rectify this problem by normalizing the data relative to the mean. First, we use a matrix Y to store the data from previous ratings, where the ith row of Y is the ratings for the ith movie and the jth column corresponds to the ratings for the jth user.</p><p>We can now define a vector</p><p><span class="MathJax_Preview"></span><span class="MathJax MathJax_Processing" id="MathJax-Element-965-Frame" role="textbox" aria-readonly="true"></span><script type="math/tex" id="MathJax-Element-965">\mu  = [\mu_1, \mu_2, \dots , \mu_{n_m}]</script></p><p>such that</p><p><span class="MathJax_Preview"></span><span class="MathJax MathJax_Processing" id="MathJax-Element-966-Frame" role="textbox" aria-readonly="true"></span><script type="math/tex" id="MathJax-Element-966">\mu_i = \frac{\sum_{j:r(i,j)=1}{Y_{i,j}}}{\sum_{j}{r(i,j)}}</script></p><p>Which is effectively the mean of the previous ratings for the ith movie (where only movies that have been watched by users are counted). We now can normalize the data by subtracting u, the mean rating, from the actual ratings for each user (column in matrix Y):</p><p>As an example, consider the following matrix Y and mean ratings μ:</p><p><span class="MathJax_Preview"></span><span class="MathJax MathJax_Processing" id="MathJax-Element-967-Frame" role="textbox" aria-readonly="true"></span><script type="math/tex" id="MathJax-Element-967">Y = 
\begin{bmatrix}
    5 & 5 & 0 & 0  \newline
    4 & ? & ? & 0  \newline
    0 & 0 & 5 & 4 \newline
    0 & 0 & 5 & 0 \newline
\end{bmatrix}, \quad
 \mu = 
\begin{bmatrix}
    2.5 \newline
    2  \newline
    2.25 \newline
    1.25 \newline
\end{bmatrix}</script></p><p>The resulting Y′ vector is:</p><p><span class="MathJax_Preview"></span><span class="MathJax MathJax_Processing" id="MathJax-Element-968-Frame" role="textbox" aria-readonly="true"></span><script type="math/tex" id="MathJax-Element-968">Y' =
\begin{bmatrix}
  2.5    & 2.5   & -2.5 & -2.5 \newline
  2      & ?     & ?    & -2 \newline
  -.2.25 & -2.25 & 3.75 & 1.25 \newline
  -1.25  & -1.25 & 3.75 & -1.25
\end{bmatrix}</script></p><p>Now we must slightly modify the linear regression prediction to include the mean normalization term:</p><p><span class="MathJax_Preview"></span><span class="MathJax MathJax_Processing" id="MathJax-Element-969-Frame" role="textbox" aria-readonly="true"></span><script type="math/tex" id="MathJax-Element-969">(\theta^{(j)})^T x^{(i)} + \mu_i</script></p><p>Now, for a new user, the initial predicted values will be equal to the μ term instead of simply being initialized to zero, which is more accurate.</p><p></p><p></p></div></div></section>